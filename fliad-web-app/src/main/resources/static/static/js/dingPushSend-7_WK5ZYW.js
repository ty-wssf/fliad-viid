import{r as e}from"./formRules-B2bzcXv4.js";import{p as a}from"./pushApi-CT8GWz8o.js";import{a as l}from"./mdEditor-CRikn6Cm.js";import{f as u}from"./fileApi-DnApfrPK.js";import{b as t,k as n}from"./ant-design-vendor-CRFwT3Wn.js";import{d as o,f as s,a1 as p,a6 as d,V as i,a2 as r,k as c,Z as h,U as m,u as v,G as f,H as y}from"./vue-vendor-BzDj5Url.js";import"./index-DcffTgQN.js";import"./office-vendor-CP0gN6-y.js";const T={key:6},g=o({name:"DingPushSend"}),U=Object.assign(g,{emits:{loadingStart:null,loadingEnd:null},setup(o,{expose:g,emit:U}){const k=U,N=s(),_=s({noticeType:"NONE",pushType:"TEXT"}),b=s(""),E={pushType:[e("请选择推送方式")],title:[e("请输入消息标题")],picUrl:[e("请输入图片URL")],messageUrl:[e("请输入跳转地址")],phones:[e("请输入手机号，多个逗号拼接")],noticeType:[e("请选择推送类型")],content:[e("请输入推送内容")]},R=(e,a,l)=>{const t=new FormData;t.append("file",l[0]),u.fileUploadLocalReturnUrl(t).then(e=>{a({url:e,desc:l[0].name})})};return g({send:()=>{N.value.validate().then(()=>{k("loadingStart");const e=t(_.value);"TEXT"===e.pushType?a.pushDingTalkText(_.value).then(()=>{n.success("推送成功")}).catch(()=>{}).finally(()=>{k("loadingEnd")}):"MARKDOWN"===e.pushType?(_.value.content=b.value,a.pushDingTalkMarkdown(_.value).then(()=>{n.success("推送成功"),b.value=""}).catch(()=>{}).finally(()=>{k("loadingEnd")})):"LINK"===e.pushType?a.pushDingTalkLink(_.value).then(()=>{n.success("推送成功")}).catch(()=>{}).finally(()=>{k("loadingEnd")}):n.warning("不支持的推送类型")}).catch(()=>{})}}),(e,a)=>{const u=p("a-radio-button"),t=p("a-radio-group"),n=p("a-form-item"),o=p("a-radio"),s=p("a-input"),g=p("a-textarea"),U=p("a-form");return i(),d(U,{ref_key:"formRef",ref:N,model:v(_),rules:E,layout:"vertical"},{default:r(()=>[c(n,{label:"推送方式：",name:"pushType"},{default:r(()=>[c(t,{value:v(_).pushType,"onUpdate:value":a[0]||(a[0]=e=>v(_).pushType=e),"button-style":"solid",onChange:a[1]||(a[1]=e=>{v(_).pushType&&(_.value.noticeType="NONE")})},{default:r(()=>[c(u,{value:"TEXT"},{default:r(()=>a[9]||(a[9]=[f("文本消息")])),_:1}),c(u,{value:"MARKDOWN"},{default:r(()=>a[10]||(a[10]=[f("Markdown")])),_:1}),c(u,{value:"LINK"},{default:r(()=>a[11]||(a[11]=[f("LINK")])),_:1})]),_:1},8,["value"])]),_:1}),"LINK"!==v(_).pushType?(i(),d(n,{key:0,label:"通知类型：",name:"noticeType"},{default:r(()=>[c(t,{value:v(_).noticeType,"onUpdate:value":a[2]||(a[2]=e=>v(_).noticeType=e)},{default:r(()=>[c(o,{value:"NONE"},{default:r(()=>a[12]||(a[12]=[f("无")])),_:1}),"TEXT"===v(_).pushType?(i(),d(o,{key:0,value:"PHONE"},{default:r(()=>a[13]||(a[13]=[f("指定手机号")])),_:1})):h("",!0),c(o,{value:"ALL"},{default:r(()=>a[14]||(a[14]=[f("通知所有人")])),_:1})]),_:1},8,["value"])]),_:1})):h("",!0),"MARKDOWN"===v(_).pushType||"LINK"===v(_).pushType?(i(),d(n,{key:1,label:"消息标题：",name:"title"},{default:r(()=>[c(s,{value:v(_).title,"onUpdate:value":a[3]||(a[3]=e=>v(_).title=e),placeholder:"请输入消息标题","allow-clear":""},null,8,["value"])]),_:1})):h("",!0),"MARKDOWN"!==v(_).pushType?(i(),d(n,{key:2,label:"消息内容：",name:"content"},{default:r(()=>[c(g,{value:v(_).content,"onUpdate:value":a[4]||(a[4]=e=>v(_).content=e),placeholder:"请输入推送内容","auto-size":{minRows:5,maxRows:10}},null,8,["value"])]),_:1})):h("",!0),"MARKDOWN"===v(_).pushType?(i(),d(n,{key:3,label:"Markdown内容："},{default:r(()=>[c(v(l),{modelValue:v(b),"onUpdate:modelValue":a[5]||(a[5]=e=>y(b)?b.value=e:null),onUploadImage:R,"disabled-menus":[],height:"500px","left-toolbar":"undo redo clear | h bold italic strikethrough quote | ul ol table hr | link image"},null,8,["modelValue"])]),_:1})):h("",!0),"LINK"===v(_).pushType?(i(),d(n,{key:4,label:"图片URL：",name:"picUrl"},{default:r(()=>[c(s,{value:v(_).picUrl,"onUpdate:value":a[6]||(a[6]=e=>v(_).picUrl=e),placeholder:"请输入图片URL","allow-clear":""},null,8,["value"])]),_:1})):h("",!0),"LINK"===v(_).pushType?(i(),d(n,{key:5,label:"跳转地址：",name:"messageUrl"},{default:r(()=>[c(s,{value:v(_).messageUrl,"onUpdate:value":a[7]||(a[7]=e=>v(_).messageUrl=e),placeholder:"请输入跳转地址","allow-clear":""},null,8,["value"])]),_:1})):h("",!0),"TEXT"===v(_).pushType?(i(),m("div",T,["PHONE"===v(_).noticeType?(i(),d(n,{key:0,label:"手机号：",name:"phones"},{default:r(()=>[c(g,{value:v(_).phones,"onUpdate:value":a[8]||(a[8]=e=>v(_).phones=e),placeholder:"请输入手机号，多个逗号拼接","auto-size":{minRows:2,maxRows:5}},null,8,["value"])]),_:1})):h("",!0)])):h("",!0)]),_:1},8,["model"])}}});export{U as default};
