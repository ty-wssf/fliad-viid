import{_ as e}from"./index-yCCQKvno.js";import{_ as a}from"./index-r8v7tfQO.js";import{_ as t,t as l}from"./index-DcffTgQN.js";import{d as r}from"./downloadUtil-80YX7TDG.js";import{u as o}from"./userApi-BNWGxnHS.js";import{o as n}from"./orgApi-CJS79xlv.js";import s from"./form-DKxnvgPk.js";import u from"./impExp-BCSJzIZC.js";import d from"./grantResourceForm-Drpt2rj4.js";import i from"./grantPermissionForm-DkZ2R9Oc.js";import{w as c,x as m,k as p}from"./ant-design-vendor-CRFwT3Wn.js";import{d as f,f as h,a1 as v,U as g,V as y,k as _,a2 as k,u as x,a6 as w,H as S,F as b,W as C,G as I,a3 as R,Z as j,Y as $}from"./vue-vendor-BzDj5Url.js";import"./index-yhO5Pkur.js";import"./index-BkEc3Qph.js";import"./formRules-B2bzcXv4.js";import"./roleApi-AgyZA8--.js";import"./scopeDefineOrg-DrvmDkXq.js";import"./treeHandler-B8ofjH1e.js";const E=["onClick"],O={class:"ant-dropdown-link"},P=["onClick"],K=["onClick"],U=["onClick"],D=["onClick"],A=f({name:"sysUser"}),B=t(Object.assign(A,{setup(t){const f=[{title:"头像",dataIndex:"avatar",align:"center",width:"80px"},{title:"账号",dataIndex:"account",ellipsis:!0},{title:"姓名",dataIndex:"name"},{title:"性别",dataIndex:"genderName",width:"50px"},{title:"手机",dataIndex:"phone",ellipsis:!0},{title:"机构",dataIndex:"orgName",ellipsis:!0},{title:"职位",dataIndex:"positionName",ellipsis:!0},{title:"状态",dataIndex:"userStatus",width:"80px"},{title:"操作",dataIndex:"action",align:"center",width:"220px"}],A=l.dictList("COMMON_STATUS"),B=h(),N=h([]),T=h({}),F=h(null),L=h([]),M=h([]),G={children:"children",title:"name",key:"id"},H=h(null),z=h(),V=h({}),W=h(!1),Y=h(!0),Z=h(),q=h(),J=h(),Q=e=>o.userPage(Object.assign(e,T.value)).then(e=>e);n.orgTree().then(e=>{Y.value=!1,null!==e&&(L.value=e,c(N.value)&&L.value.forEach(e=>{"0"===e.parentId&&(N.value.push(e.id),e.children&&e.children.forEach(e=>{N.value.push(e.id)}))}))});const X={alert:{show:!1,clear:()=>{M.value=h([])}},rowSelection:{onChange:(e,a)=>{M.value=e}}},ee=()=>{B.value.resetFields(),F.value.refresh(!0)},ae=e=>{e.length>0?T.value.orgId=e.toString():delete T.value.orgId,F.value.refresh(!0)},te=()=>{if(M.value.length<1&!T.value.searchKey&!T.value.userStatus&&p.warning("请输入查询条件或勾选要导出的信息"),M.value.length>0){const e={userIds:M.value.map(e=>e).join()};return void le(e)}if(T.value.searchKey||T.value.userStatus){const e={searchKey:T.value.searchKey,userStatus:T.value.userStatus};le(e)}},le=e=>{o.userExport(e).then(e=>{r.resultDownload(e),F.value.clearSelected()})},re=e=>{o.userDelete(e).then(()=>{F.value.clearRefreshSelected()})},oe=e=>{let a={id:V.value.id,roleIdList:[]};e.length>0&&e.forEach(e=>{a.roleIdList.push(e)}),o.grantRole(a).then(()=>{})},ne={orgTreeApi:e=>o.userOrgTreeSelector(e).then(e=>Promise.resolve(e)),rolePageApi:e=>o.userRoleSelector(e).then(e=>Promise.resolve(e))};return(t,l)=>{const n=v("a-tree"),c=v("a-empty"),p=v("a-card"),h=v("a-col"),le=v("a-input"),se=v("a-form-item"),ue=v("a-select-option"),de=v("a-select"),ie=v("SearchOutlined"),ce=v("a-button"),me=v("redo-outlined"),pe=v("a-row"),fe=v("a-form"),he=v("plus-outlined"),ve=v("import-outlined"),ge=v("export-outlined"),ye=a,_e=v("a-space"),ke=v("a-avatar"),xe=v("a-switch"),we=v("a-divider"),Se=v("a-popconfirm"),be=v("DownOutlined"),Ce=v("a-menu-item"),Ie=v("a-menu"),Re=v("a-dropdown"),je=v("s-table"),$e=e;return y(),g(b,null,[_(pe,{gutter:10},{default:k(()=>[_(h,{xs:24,sm:24,md:24,lg:5,xl:5},{default:k(()=>[_(p,{bordered:!1,loading:x(Y),class:"left-tree-container mb-3"},{default:k(()=>[x(L).length>0?(y(),w(n,{key:0,expandedKeys:x(N),"onUpdate:expandedKeys":l[0]||(l[0]=e=>S(N)?N.value=e:null),"tree-data":x(L),"field-names":G,onSelect:ae},null,8,["expandedKeys","tree-data"])):(y(),w(c,{key:1,image:x(m).PRESENTED_IMAGE_SIMPLE},null,8,["image"]))]),_:1},8,["loading"])]),_:1}),_(h,{xs:24,sm:24,md:24,lg:19,xl:19},{default:k(()=>[_(p,{bordered:!1,class:"xn-mb10"},{default:k(()=>[_(fe,{ref_key:"searchFormRef",ref:B,name:"advanced_search",class:"ant-advanced-search-form",model:x(T)},{default:k(()=>[_(pe,{gutter:24},{default:k(()=>[_(h,{span:8},{default:k(()=>[_(se,{name:"searchKey",label:t.$t("common.searchKey")},{default:k(()=>[_(le,{value:x(T).searchKey,"onUpdate:value":l[1]||(l[1]=e=>x(T).searchKey=e),placeholder:t.$t("user.placeholderNameAndSearchKey")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),_(h,{span:8},{default:k(()=>[_(se,{name:"userStatus",label:t.$t("user.userStatus")},{default:k(()=>[_(de,{value:x(T).userStatus,"onUpdate:value":l[2]||(l[2]=e=>x(T).userStatus=e),placeholder:t.$t("user.placeholderUserStatus"),getPopupContainer:e=>e.parentNode},{default:k(()=>[(y(!0),g(b,null,C(x(A),e=>(y(),w(ue,{key:e.value,value:e.value},{default:k(()=>[I(R(e.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder","getPopupContainer"])]),_:1},8,["label"])]),_:1}),_(h,{span:8},{default:k(()=>[_(ce,{type:"primary",onClick:l[3]||(l[3]=e=>x(F).refresh(!0))},{icon:k(()=>[_(ie)]),default:k(()=>[I(" "+R(t.$t("common.searchButton")),1)]),_:1}),_(ce,{class:"snowy-button-left",onClick:ee},{icon:k(()=>[_(me)]),default:k(()=>[I(" "+R(t.$t("common.resetButton")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),_(p,{bordered:!1},{default:k(()=>[_(je,{ref_key:"tableRef",ref:F,columns:f,data:Q,"expand-row-by-click":!0,bordered:"",alert:X.alert.show,"row-key":e=>e.id,"row-selection":X.rowSelection},{operator:k(()=>[_(_e,null,{default:k(()=>[_(ce,{type:"primary",onClick:l[4]||(l[4]=e=>x(H).onOpen(void 0,x(T).orgId))},{icon:k(()=>[_(he)]),default:k(()=>[$("span",null,R(t.$t("common.addButton"))+R(t.$t("model.user")),1)]),_:1}),_(ce,{onClick:l[5]||(l[5]=e=>x(Z).onOpen())},{icon:k(()=>[_(ve)]),default:k(()=>[$("span",null,R(t.$t("common.imports")),1)]),_:1}),_(ce,{onClick:te},{icon:k(()=>[_(ge)]),default:k(()=>[I(" "+R(t.$t("user.batchExportButton")),1)]),_:1}),_(ye,{buttonName:t.$t("common.batchRemoveButton"),icon:"DeleteOutlined",buttonDanger:"",selectedRowKeys:x(M),onBatchCallBack:re},null,8,["buttonName","selectedRowKeys"])]),_:1})]),bodyCell:k(({column:e,record:a})=>["avatar"===e.dataIndex?(y(),w(ke,{key:0,src:a.avatar,style:{"margin-bottom":"-5px","margin-top":"-5px"}},null,8,["src"])):j("",!0),"gender"===e.dataIndex?(y(),g(b,{key:1},[I(R(t.$TOOL.dictTypeData("GENDER",a.gender)),1)],64)):j("",!0),"userStatus"===e.dataIndex?(y(),w(xe,{key:2,loading:x(W),checked:"ENABLE"===a.userStatus,onChange:e=>(e=>{W.value=!0,"ENABLE"===e.userStatus?o.userDisableUser(e).then(()=>{F.value.refresh()}).finally(()=>{W.value=!1}):o.userEnableUser(e).then(()=>{F.value.refresh()}).finally(()=>{W.value=!1})})(a)},null,8,["loading","checked","onChange"])):j("",!0),"action"===e.dataIndex?(y(),g(b,{key:3},[$("a",{onClick:e=>x(H).onOpen(a)},R(t.$t("common.editButton")),9,E),_(we,{type:"vertical"}),_(Se,{title:t.$t("user.popconfirmDeleteUser"),placement:"topRight",onConfirm:e=>(e=>{let a=[{id:e.id}];o.userDelete(a).then(()=>{F.value.refresh()})})(a)},{default:k(()=>[_(ce,{type:"link",danger:"",size:"small"},{default:k(()=>[I(R(t.$t("common.removeButton")),1)]),_:1})]),_:2},1032,["title","onConfirm"]),_(we,{type:"vertical"}),_(Re,null,{overlay:k(()=>[_(Ie,null,{default:k(()=>[_(Ce,null,{default:k(()=>[_(Se,{title:t.$t("user.popconfirmResatUserPwd"),placement:"topRight",onConfirm:e=>(e=>{o.userResetPassword(e).then(()=>{})})(a)},{default:k(()=>[$("a",null,R(t.$t("user.resetPassword")),1)]),_:2},1032,["title","onConfirm"])]),_:2},1024),_(Ce,null,{default:k(()=>[$("a",{onClick:e=>(e=>{V.value=e;const a={id:e.id};o.userOwnRole(a).then(e=>{z.value.showModel(e)})})(a)},R(t.$t("user.grantRole")),9,P)]),_:2},1024),_(Ce,null,{default:k(()=>[$("a",{onClick:e=>x(q).onOpen(a)},R(t.$t("user.grantResource")),9,K)]),_:2},1024),_(Ce,null,{default:k(()=>[$("a",{onClick:e=>x(J).onOpen(a)},R(t.$t("user.grantPermission")),9,U)]),_:2},1024),_(Ce,null,{default:k(()=>[$("a",{onClick:e=>(e=>{const a={id:e.id};o.userExportUserInfo(a).then(e=>{r.resultDownload(e)})})(a)},R(t.$t("user.exportUserInfo")),9,D)]),_:2},1024)]),_:2},1024)]),default:k(()=>[$("a",O,[I(R(t.$t("common.more"))+" ",1),_(be)])]),_:2},1024)],64)):j("",!0)]),_:1},8,["alert","row-key","row-selection"])]),_:1})]),_:1})]),_:1}),_(s,{ref_key:"formRef",ref:H,onSuccessful:l[6]||(l[6]=e=>x(F).refresh())},null,512),_($e,{ref_key:"RoleSelectorPlusRef",ref:z,"org-tree-api":ne.orgTreeApi,"role-page-api":ne.rolePageApi,"add-show":!1,show:!1,"role-global":!0,onOnBack:oe},null,8,["org-tree-api","role-page-api"]),_(u,{ref_key:"ImpExpRef",ref:Z},null,512),_(d,{ref_key:"grantResourceFormRef",ref:q,onSuccessful:l[7]||(l[7]=e=>x(F).refresh())},null,512),_(i,{ref_key:"grantPermissionFormRef",ref:J,onSuccessful:l[8]||(l[8]=e=>x(F).refresh())},null,512)],64)}}}),[["__scopeId","data-v-d37e0bbd"]]);export{B as default};
