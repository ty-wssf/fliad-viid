import{_ as e}from"./index-yhO5Pkur.js";import{_ as l}from"./index-BkEc3Qph.js";import{u as a}from"./userApi-BNWGxnHS.js";import{_ as o,t,c as n}from"./index-DcffTgQN.js";import{r as u}from"./formRules-B2bzcXv4.js";import{f as d,a1 as r,a6 as s,V as i,a2 as c,k as p,u as f,H as v,U as m,G as _,F as h,W as g,n as b}from"./vue-vendor-BzDj5Url.js";import"./ant-design-vendor-CRFwT3Wn.js";const y=o({__name:"form",emits:{successful:null},setup(o,{expose:y,emit:w}){const U=d(!1),I=d(),P=d("1"),x=w,k=d(!1),J=d([]),S=d([]),C=d(),L=d(),R=d(),N=d(),T=d({}),A=()=>{J.value=[],S.value=[],U.value=!1},O=e=>{const l={id:e.id};a.userDetail(l).then(e=>{e.positionJson&&(e.positionJson=JSON.parse(e.positionJson)),T.value=Object.assign(T.value,e),e.positionJson&&e.positionJson.map((e,l)=>(E(e,1,l),e)),j(T.value.orgId)})},D={account:[u("请输入账号")],name:[u("请输入姓名")],sex:[u("请选择性别")],orgId:[u("请选择组织")],positionId:[u("请选择职位")]},j=(e,l)=>{if(e){const a={orgId:e};C.value.onPage(a),L.value.onPage(),0===l&&(T.value.positionId=void 0,T.value.directorId=void 0)}else T.value.positionId=void 0,T.value.directorId=void 0},Y={positionSelector:e=>a.userPositionSelector(e).then(e=>Promise.resolve(e)),userSelector:e=>a.userSelector(e).then(e=>Promise.resolve(e)),childPositionSelector:e=>a.userPositionSelector(e).then(e=>Promise.resolve(e)),childUserSelector:e=>a.userSelector(e).then(e=>Promise.resolve(e)),echoPosition:e=>n.userCenterGetPositionListByIdList(e).then(e=>Promise.resolve(e)),echoUser:e=>n.userCenterGetUserListByIdList(e).then(e=>Promise.resolve(e))},E=(e,l,a)=>{0===l&&T.value.positionJson.filter((l,o)=>{l.orgId===e.orgId&&o===a&&(l.positionId=void 0,l.directorId=void 0)});const o={orgId:e.orgId};b(()=>{R.value[a].onPage(o),N.value[a].onPage(o)})},z=()=>{I.value.validate().then(()=>{let e=JSON.parse(JSON.stringify(T.value));e.positionJson&&e.positionJson.length>0?e.positionJson=JSON.stringify(e.positionJson):delete e.positionJson,k.value=!0,a.submitForm(e,e.id).then(()=>{A(),x("successful")}).finally(()=>{k.value=!1})}).catch(()=>{})},G=t.dictList("GENDER"),M=t.dictList("NATION"),H=t.dictList("IDCARD_TYPE"),K=t.dictList("CULTURE_LEVEL");return y({onOpen:(e,l)=>{U.value=!0,T.value={gender:"男",positionJson:[]},l&&(T.value.orgId=l,b(()=>{j(l)})),e&&O(e),b(()=>{a.userOrgTreeSelector().then(e=>{null!==e&&(J.value=e,J.value.forEach(e=>{"0"===e.parentId&&(S.value.push(e.id),e.children&&e.children.forEach(e=>{S.value.push(e.id)}))}))})})}}),(a,o)=>{const t=r("a-input"),n=r("a-form-item"),u=r("a-col"),d=r("a-row"),b=r("a-radio-group"),y=r("a-date-picker"),w=r("a-tree-select"),x=l,O=r("PlusOutlined"),q=r("a-button"),B=r("a-tab-pane"),F=r("a-select"),V=r("a-textarea"),W=r("a-tabs"),Q=r("a-form"),X=e;return i(),s(X,{title:f(T).id?"编辑用户":"增加用户",width:800,visible:f(U),"destroy-on-close":!0,"body-style":{"padding-top":"0px"},onClose:A},{footer:c(()=>[p(q,{class:"xn-mr8",onClick:A},{default:c(()=>o[38]||(o[38]=[_("关闭")])),_:1}),p(q,{type:"primary",loading:f(k),onClick:z},{default:c(()=>o[39]||(o[39]=[_("保存")])),_:1},8,["loading"])]),default:c(()=>[p(Q,{ref_key:"formRef",ref:I,model:f(T),rules:D,layout:"vertical"},{default:c(()=>[p(W,{activeKey:f(P),"onUpdate:activeKey":o[32]||(o[32]=e=>v(P)?P.value=e:null)},{default:c(()=>[p(B,{key:"1",tab:"基础信息","force-render":""},{default:c(()=>[p(d,{gutter:16},{default:c(()=>[p(u,{span:12},{default:c(()=>[p(n,{label:"账号：",name:"account"},{default:c(()=>[p(t,{value:f(T).account,"onUpdate:value":o[0]||(o[0]=e=>f(T).account=e),placeholder:"请输入账号","allow-clear":""},null,8,["value"])]),_:1})]),_:1}),p(u,{span:12},{default:c(()=>[p(n,{label:"姓名：",name:"name"},{default:c(()=>[p(t,{value:f(T).name,"onUpdate:value":o[1]||(o[1]=e=>f(T).name=e),placeholder:"请输入姓名","allow-clear":""},null,8,["value"])]),_:1})]),_:1})]),_:1}),p(d,{gutter:16},{default:c(()=>[p(u,{span:12},{default:c(()=>[p(n,{label:"性别：",name:"gender"},{default:c(()=>[p(b,{value:f(T).gender,"onUpdate:value":o[2]||(o[2]=e=>f(T).gender=e),options:f(G)},null,8,["value","options"])]),_:1})]),_:1}),p(u,{span:12},{default:c(()=>[p(n,{label:"昵称：",name:"nickname"},{default:c(()=>[p(t,{value:f(T).nickname,"onUpdate:value":o[3]||(o[3]=e=>f(T).nickname=e),placeholder:"请输入昵称","allow-clear":""},null,8,["value"])]),_:1})]),_:1})]),_:1}),p(d,{gutter:16},{default:c(()=>[p(u,{span:12},{default:c(()=>[p(n,{label:"手机号：",name:"phone"},{default:c(()=>[p(t,{value:f(T).phone,"onUpdate:value":o[4]||(o[4]=e=>f(T).phone=e),placeholder:"请输入手机","allow-clear":""},null,8,["value"])]),_:1})]),_:1}),p(u,{span:12},{default:c(()=>[p(n,{label:"邮箱：",name:"email"},{default:c(()=>[p(t,{value:f(T).email,"onUpdate:value":o[5]||(o[5]=e=>f(T).email=e),placeholder:"请输入邮箱","allow-clear":""},null,8,["value"])]),_:1})]),_:1})]),_:1}),p(d,{gutter:16},{default:c(()=>[p(u,{span:12},{default:c(()=>[p(n,{label:"出生日期：",name:"birthday"},{default:c(()=>[p(y,{value:f(T).birthday,"onUpdate:value":o[6]||(o[6]=e=>f(T).birthday=e),"value-format":"YYYY-MM-DD",class:"xn-wd"},null,8,["value"])]),_:1})]),_:1})]),_:1}),p(d,{gutter:16},{default:c(()=>[p(u,{span:8},{default:c(()=>[p(n,{label:"选择组织：",name:"orgId"},{default:c(()=>[p(w,{value:f(T).orgId,"onUpdate:value":o[7]||(o[7]=e=>f(T).orgId=e),class:"xn-wd","dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择组织","allow-clear":"","tree-default-expand-all":"","tree-data":f(J),"tree-default-expanded-keys":f(S),"field-names":{children:"children",label:"name",value:"id"},onChange:o[8]||(o[8]=e=>j(f(T).orgId,0))},null,8,["value","tree-data","tree-default-expanded-keys"])]),_:1})]),_:1}),p(u,{span:8},{default:c(()=>[p(n,{label:"选择职位：",name:"positionId"},{default:c(()=>[p(x,{ref_key:"xnPositionPageSelectRef",ref:C,value:f(T).positionId,"onUpdate:value":o[9]||(o[9]=e=>f(T).positionId=e),placeholder:"请选择职位","allow-clear":"","page-function":Y.positionSelector,"echo-function":Y.echoPosition},null,8,["value","page-function","echo-function"])]),_:1})]),_:1}),p(u,{span:8},{default:c(()=>[p(n,{label:"选择主管：",name:"directorId"},{default:c(()=>[p(x,{ref_key:"xnUserPageSelectRef",ref:L,value:f(T).directorId,"onUpdate:value":o[10]||(o[10]=e=>f(T).directorId=e),placeholder:"请选择主管","allow-clear":"","page-function":Y.userSelector,"echo-function":Y.echoUser},null,8,["value","page-function","echo-function"])]),_:1})]),_:1})]),_:1}),p(d,{gutter:16},{default:c(()=>[p(u,{span:8},{default:c(()=>[p(n,{label:"员工编号：",name:"empNo"},{default:c(()=>[p(t,{value:f(T).empNo,"onUpdate:value":o[11]||(o[11]=e=>f(T).empNo=e),placeholder:"请输入员工编号","allow-clear":""},null,8,["value"])]),_:1})]),_:1}),p(u,{span:8},{default:c(()=>[p(n,{label:"职级：",name:"positionLevel"},{default:c(()=>[p(t,{value:f(T).positionLevel,"onUpdate:value":o[12]||(o[12]=e=>f(T).positionLevel=e),placeholder:"请输入职级","allow-clear":""},null,8,["value"])]),_:1})]),_:1}),p(u,{span:8},{default:c(()=>[p(n,{label:"入职日期：",name:"entryDate"},{default:c(()=>[p(y,{value:f(T).entryDate,"onUpdate:value":o[13]||(o[13]=e=>f(T).entryDate=e),"value-format":"YYYY-MM-DD",class:"xn-wd"},null,8,["value"])]),_:1})]),_:1})]),_:1}),p(n,{label:"任职信息",name:"positionJson"},{default:c(()=>[p(d,{gutter:10,class:"form-row"},{default:c(()=>[p(u,{span:7,class:"form-row-con"},{default:c(()=>o[33]||(o[33]=[_(" 机构 ")])),_:1}),p(u,{span:7,class:"form-row-con"},{default:c(()=>o[34]||(o[34]=[_(" 职位 ")])),_:1}),p(u,{span:7,class:"form-row-con"},{default:c(()=>o[35]||(o[35]=[_(" 主管 ")])),_:1}),p(u,{span:3,class:"form-row-con"},{default:c(()=>[p(q,{type:"primary",onClick:o[14]||(o[14]=e=>(null===T.value.positionJson&&(T.value.positionJson=[]),void T.value.positionJson.push({orgId:void 0,positionId:void 0,directorId:void 0}))),size:"small"},{default:c(()=>[p(O),o[36]||(o[36]=_(" 增加 "))]),_:1})]),_:1})]),_:1}),(i(!0),m(h,null,g(f(T).positionJson,(e,l)=>(i(),m("div",{key:e},[p(d,{gutter:10},{default:c(()=>[p(u,{span:7},{default:c(()=>[p(n,{name:["positionJson",l,"orgId"],rules:{required:!0,message:"请选择组织"}},{default:c(()=>[p(w,{value:e.orgId,"onUpdate:value":l=>e.orgId=l,class:"xn-wd","dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择组织","allow-clear":"","tree-default-expand-all":"","tree-data":f(J),"tree-default-expanded-keys":f(S),"field-names":{children:"children",label:"name",value:"id"},onSelect:a=>E(e,0,l)},null,8,["value","onUpdate:value","tree-data","tree-default-expanded-keys","onSelect"])]),_:2},1032,["name"])]),_:2},1024),p(u,{span:7},{default:c(()=>[p(n,{name:["positionJson",l,"positionId"],rules:{required:!0,message:"请选择职位"}},{default:c(()=>[p(x,{ref_for:!0,ref_key:"xnChildPositionPageSelectRef",ref:R,value:e.positionId,"onUpdate:value":l=>e.positionId=l,placeholder:"请选择职位","allow-clear":"","page-function":Y.childPositionSelector,"echo-function":Y.echoPosition},null,8,["value","onUpdate:value","page-function","echo-function"])]),_:2},1032,["name"])]),_:2},1024),p(u,{span:7},{default:c(()=>[p(n,{name:["positionJson",l,"directorId"]},{default:c(()=>[p(x,{ref_for:!0,ref_key:"xnChildUserPageSelectRef",ref:N,value:e.directorId,"onUpdate:value":l=>e.directorId=l,placeholder:"请选择主管","allow-clear":"","page-function":Y.childUserSelector,"echo-function":Y.echoUser},null,8,["value","onUpdate:value","page-function","echo-function"])]),_:2},1032,["name"])]),_:2},1024),p(u,{span:3,class:"xn-mt4"},{default:c(()=>[p(q,{size:"small",type:"primary",danger:"",ghost:"",onClick:e=>(e=>{T.value.positionJson.splice(e,1)})(l)},{default:c(()=>o[37]||(o[37]=[_("移除")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]))),128))]),_:1})]),_:1}),p(B,{key:"2",tab:"更多信息","force-render":""},{default:c(()=>[p(d,{gutter:16},{default:c(()=>[p(u,{span:12},{default:c(()=>[p(n,{label:"民族：",name:"nation"},{default:c(()=>[p(F,{value:f(T).nation,"onUpdate:value":o[15]||(o[15]=e=>f(T).nation=e),placeholder:"请选择民族",options:f(M)},null,8,["value","options"])]),_:1})]),_:1}),p(u,{span:12},{default:c(()=>[p(n,{label:"籍贯：",name:"nativePlace"},{default:c(()=>[p(t,{value:f(T).nativePlace,"onUpdate:value":o[16]||(o[16]=e=>f(T).nativePlace=e),placeholder:"请输入籍贯","allow-clear":""},null,8,["value"])]),_:1})]),_:1})]),_:1}),p(d,{gutter:16},{default:c(()=>[p(u,{span:12},{default:c(()=>[p(n,{label:"家庭住址：",name:"homeAddress"},{default:c(()=>[p(V,{value:f(T).homeAddress,"onUpdate:value":o[17]||(o[17]=e=>f(T).homeAddress=e),placeholder:"请输入家庭住址","auto-size":{minRows:2,maxRows:5},"allow-clear":""},null,8,["value"])]),_:1})]),_:1}),p(u,{span:12},{default:c(()=>[p(n,{label:"通信地址：",name:"mailingAddress"},{default:c(()=>[p(V,{value:f(T).mailingAddress,"onUpdate:value":o[18]||(o[18]=e=>f(T).mailingAddress=e),placeholder:"请输入通信地址","auto-size":{minRows:2,maxRows:5},"allow-clear":""},null,8,["value"])]),_:1})]),_:1})]),_:1}),p(d,{gutter:16},{default:c(()=>[p(u,{span:12},{default:c(()=>[p(n,{label:"证件类型：",name:"idCardType"},{default:c(()=>[p(F,{value:f(T).idCardType,"onUpdate:value":o[19]||(o[19]=e=>f(T).idCardType=e),placeholder:"请选择证件类型",options:f(H)},null,8,["value","options"])]),_:1})]),_:1}),p(u,{span:12},{default:c(()=>[p(n,{label:"证件号码：",name:"idCardNumber"},{default:c(()=>[p(t,{value:f(T).idCardNumber,"onUpdate:value":o[20]||(o[20]=e=>f(T).idCardNumber=e),placeholder:"请输入证件号码","allow-clear":""},null,8,["value"])]),_:1})]),_:1})]),_:1}),p(d,{gutter:16},{default:c(()=>[p(u,{span:12},{default:c(()=>[p(n,{label:"文化程度：",name:"cultureLevel"},{default:c(()=>[p(F,{value:f(T).cultureLevel,"onUpdate:value":o[21]||(o[21]=e=>f(T).cultureLevel=e),placeholder:"请选择文化程度",options:f(K)},null,8,["value","options"])]),_:1})]),_:1}),p(u,{span:12},{default:c(()=>[p(n,{label:"政治面貌：",name:"politicalOutlook"},{default:c(()=>[p(t,{value:f(T).politicalOutlook,"onUpdate:value":o[22]||(o[22]=e=>f(T).politicalOutlook=e),placeholder:"请输入政治面貌","allow-clear":""},null,8,["value"])]),_:1})]),_:1})]),_:1}),p(d,{gutter:16},{default:c(()=>[p(u,{span:12},{default:c(()=>[p(n,{label:"毕业学校：",name:"college"},{default:c(()=>[p(t,{value:f(T).college,"onUpdate:value":o[23]||(o[23]=e=>f(T).college=e),placeholder:"请输入毕业学校","allow-clear":""},null,8,["value"])]),_:1})]),_:1}),p(u,{span:12},{default:c(()=>[p(n,{label:"学历：",name:"education"},{default:c(()=>[p(t,{value:f(T).education,"onUpdate:value":o[24]||(o[24]=e=>f(T).education=e),placeholder:"请输入学历","allow-clear":""},null,8,["value"])]),_:1})]),_:1})]),_:1}),p(d,{gutter:16},{default:c(()=>[p(u,{span:12},{default:c(()=>[p(n,{label:"学制：",name:"eduLength"},{default:c(()=>[p(t,{value:f(T).eduLength,"onUpdate:value":o[25]||(o[25]=e=>f(T).eduLength=e),placeholder:"请输入学制","allow-clear":""},null,8,["value"])]),_:1})]),_:1}),p(u,{span:12},{default:c(()=>[p(n,{label:"学位：",name:"degree"},{default:c(()=>[p(t,{value:f(T).degree,"onUpdate:value":o[26]||(o[26]=e=>f(T).degree=e),placeholder:"请输入学位","allow-clear":""},null,8,["value"])]),_:1})]),_:1})]),_:1}),p(d,{gutter:16},{default:c(()=>[p(u,{span:12},{default:c(()=>[p(n,{label:"家庭电话：",name:"homeTel"},{default:c(()=>[p(t,{value:f(T).homeTel,"onUpdate:value":o[27]||(o[27]=e=>f(T).homeTel=e),placeholder:"请输入家庭电话","allow-clear":""},null,8,["value"])]),_:1})]),_:1}),p(u,{span:12},{default:c(()=>[p(n,{label:"办公电话：",name:"officeTel"},{default:c(()=>[p(t,{value:f(T).officeTel,"onUpdate:value":o[28]||(o[28]=e=>f(T).officeTel=e),placeholder:"请输入办公电话","allow-clear":""},null,8,["value"])]),_:1})]),_:1})]),_:1}),p(d,{gutter:16},{default:c(()=>[p(u,{span:12},{default:c(()=>[p(n,{label:"紧急联系人：",name:"emergencyContact"},{default:c(()=>[p(t,{value:f(T).emergencyContact,"onUpdate:value":o[29]||(o[29]=e=>f(T).emergencyContact=e),placeholder:"请输入紧急联系人","allow-clear":""},null,8,["value"])]),_:1})]),_:1}),p(u,{span:12},{default:c(()=>[p(n,{label:"紧急联系电话：",name:"emergencyPhone"},{default:c(()=>[p(t,{value:f(T).emergencyPhone,"onUpdate:value":o[30]||(o[30]=e=>f(T).emergencyPhone=e),placeholder:"请输入紧急联系电话","allow-clear":""},null,8,["value"])]),_:1})]),_:1})]),_:1}),p(d,{gutter:16},{default:c(()=>[p(u,{span:12},{default:c(()=>[p(n,{label:"紧急联系人地址：",name:"emergencyAddress"},{default:c(()=>[p(V,{value:f(T).emergencyAddress,"onUpdate:value":o[31]||(o[31]=e=>f(T).emergencyAddress=e),placeholder:"请输入紧急联系人地址","auto-size":{minRows:2,maxRows:5},"allow-clear":""},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["activeKey"])]),_:1},8,["model"])]),_:1},8,["title","visible"])}}},[["__scopeId","data-v-aebcf118"]]);export{y as default};
