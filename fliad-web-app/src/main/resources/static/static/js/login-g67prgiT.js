const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/js/phoneLoginForm-DDc_UADq.js","static/js/formRules-B2bzcXv4.js","static/js/clientLoginApi-CbOluBR5.js","static/js/index-DcffTgQN.js","static/js/vue-vendor-BzDj5Url.js","static/js/ant-design-vendor-CRFwT3Wn.js","static/css/index-5e_7XRvV.css","static/js/util-CNugiXN7.js","static/js/emailLoginForm-DWkH-L1h.js"])))=>i.map(i=>d[i]);
import{_ as e,D as a,t as l,g as o,f as t}from"./index-DcffTgQN.js";import{a5 as s,f as n,r as d,c as i,o as u,w as r,a1 as _,U as c,V as v,Y as f,k as p,a2 as m,Z as C,H as g,u as S,a6 as O,ah as y,G as A,a0 as L}from"./vue-vendor-BzDj5Url.js";import{c as E}from"./clientLoginApi-CbOluBR5.js";import{s as N}from"./smCrypto-fJLAcgxS.js";import{r as F}from"./formRules-B2bzcXv4.js";import{a as h}from"./util-CNugiXN7.js";import{c as R}from"./configApi-BMiyCPj3.js";import"./ant-design-vendor-CRFwT3Wn.js";const Y={class:"login-wrapper"},G={class:"login_main"},b={class:"login-form"},w={key:0},T=["src"],U={key:0},k=e({__name:"login",setup(e){const k=L(()=>t(()=>import("./phoneLoginForm-DDc_UADq.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),I=L(()=>t(()=>import("./emailLoginForm-DWkH-L1h.js"),__vite__mapDeps([8,1,2,3,4,5,6,7])));s();const W=n("userAccount"),j=n(a.SYS_BASE_CONFIG.SNOWY_SYS_DEFAULT_CAPTCHA_OPEN_FLAG_FOR_C),P=n("false"),D=n("false"),B=n("false"),K=n(""),H=n(!1),q=n(!1),x=n([]),z=n(!1),V=d({validCode:"",validCodeReqNo:"",autologin:!1,tenCode:""}),M=d({account:[F("请输入账号","blur")],password:[F("请输入密码","blur")],tenCode:[F("请选择租户","blur")]}),Z=n({theme:l.data.get("APP_THEME")||"default"}),J=o(),Q=J.setSysBaseConfig;i(()=>J.sysBaseConfig),u(()=>{X()});const X=()=>{let e=n(a.SYS_BASE_CONFIG);R.configSysBaseList().then(a=>{z.value=!1,a&&(a.forEach(a=>{e.value[a.configKey]=a.configValue}),j.value=e.value.SNOWY_SYS_DEFAULT_CAPTCHA_OPEN_FLAG_FOR_C,P.value=e.value.SNOWY_SYS_DEFAULT_ALLOW_REGISTER_FLAG_FOR_C,D.value=e.value.SNOWY_SYS_DEFAULT_ALLOW_PHONE_LOGIN_FLAG_FOR_C,B.value=e.value.SNOWY_SYS_DEFAULT_ALLOW_EMAIL_LOGIN_FLAG_FOR_C,l.data.set("SNOWY_SYS_BASE_CONFIG",e.value),Q(e.value),$())}).catch(()=>{})};r(()=>Z.value.theme,e=>{document.body.setAttribute("data-theme",e)});const $=()=>{"true"===j.value&&(ee(),M.validCode=[F("请输入验证码","blur")])},ee=()=>{E.clientGetPicCaptcha().then(e=>{K.value=e.validCodeBase64,V.validCodeReqNo=e.validCodeReqNo,V.validCode=void 0})},ae=n(),le=async()=>{ae.value.validate().then(async()=>{H.value=!0;const e={account:V.account,password:N.doSm2Encrypt(V.password),validCode:V.validCode,validCodeReqNo:V.validCodeReqNo};try{const a=await E.clientLogin(e);await h(a)}catch(a){"true"===j.value&&ee()}}).finally(()=>{H.value=!1})},oe=e=>{l.data.set("SNOWY_TEN_CODE",e),V.tenCode=e,X()};return(e,l)=>{const o=_("a-select"),t=_("a-form-item"),s=_("UserOutlined"),n=_("a-input"),d=_("LockOutlined"),i=_("a-input-password"),u=_("verified-outlined"),r=_("a-col"),L=_("a-row"),E=_("a-button"),N=_("a-form"),F=_("a-tab-pane"),h=_("a-tabs"),R=_("a-card");return v(),c("div",Y,[f("div",G,[f("div",b,[p(R,null,{default:m(()=>[l[7]||(l[7]=f("div",{class:"login-header"},[f("h2",null,"登录")],-1)),p(h,{activeKey:S(W),"onUpdate:activeKey":l[4]||(l[4]=e=>g(W)?W.value=e:null)},{default:m(()=>[p(F,{key:"userAccount",tab:"账号密码"},{default:m(()=>[p(N,{ref_key:"loginForm",ref:ae,model:S(V),rules:S(M)},{default:m(()=>[S(q)?(v(),c("div",w,[S(x).length>1||!S(V).tenCode?(v(),O(t,{key:0,name:"tenCode"},{default:m(()=>[p(o,{value:S(V).tenCode,"onUpdate:value":l[0]||(l[0]=e=>S(V).tenCode=e),size:"large",placeholder:"请选择租户",options:S(x),onChange:oe},null,8,["value","options"])]),_:1})):C("",!0)])):C("",!0),p(t,{name:"account"},{default:m(()=>[p(n,{value:S(V).account,"onUpdate:value":l[1]||(l[1]=e=>S(V).account=e),placeholder:"请输入账号",size:"large",onKeyup:y(le,["enter"])},{prefix:m(()=>[p(s,{class:"login-icon-gray"})]),_:1},8,["value"])]),_:1}),p(t,{name:"password"},{default:m(()=>[p(i,{value:S(V).password,"onUpdate:value":l[2]||(l[2]=e=>S(V).password=e),placeholder:"请输入密码",size:"large",autocomplete:"off",onKeyup:y(le,["enter"])},{prefix:m(()=>[p(d,{class:"login-icon-gray"})]),_:1},8,["value"])]),_:1}),"true"===S(j)?(v(),O(t,{key:1,name:"validCode"},{default:m(()=>[p(L,{gutter:8},{default:m(()=>[p(r,{span:17},{default:m(()=>[p(n,{value:S(V).validCode,"onUpdate:value":l[3]||(l[3]=e=>S(V).validCode=e),placeholder:"请输入验证码",size:"large",onKeyup:y(le,["enter"])},{prefix:m(()=>[p(u,{class:"login-icon-gray"})]),_:1},8,["value"])]),_:1}),p(r,{span:7},{default:m(()=>[f("img",{src:S(K),class:"login-validCode-img",onClick:ee},null,8,T)]),_:1})]),_:1})]),_:1})):C("",!0),p(t,null,{default:m(()=>[p(E,{type:"primary",class:"w-full",loading:S(H),round:"",size:"large",onClick:le,disabled:S(z)},{default:m(()=>l[5]||(l[5]=[A(" 登录 ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1}),"true"===S(D)?(v(),O(F,{key:"userSms",tab:"手机号登录","force-render":""},{default:m(()=>[p(S(k))]),_:1})):C("",!0),"true"===S(B)?(v(),O(F,{key:"userEmail",tab:"邮箱号登录","force-render":""},{default:m(()=>[p(S(I))]),_:1})):C("",!0)]),_:1},8,["activeKey"]),S(a).FRONT_BACK_LOGIN_URL_SHOW?(v(),c("div",U,l[6]||(l[6]=[f("a",{href:"/login"},"后台登录",-1)]))):C("",!0)]),_:1})])])])}}},[["__scopeId","data-v-06a2a93e"]]);export{k as default};
