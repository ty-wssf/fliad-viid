import{_ as e}from"./index-yhO5Pkur.js";import{t as l}from"./index-DcffTgQN.js";import{S as a}from"./snowflake-id-Ddy3gscf.js";import{r as t}from"./formRules-B2bzcXv4.js";import{m as o}from"./menuApi-DbbBCSCl.js";import{_ as n}from"./index-ssHdgZ9Y.js";import{I as u}from"./iconMobileSelector-DPTyXE9K.js";import{k as s,b as d}from"./ant-design-vendor-CRFwT3Wn.js";import{d as r,f as i,a1 as p,a6 as c,V as m,a2 as v,k as f,u as _,Z as b,H as y,G as h,a3 as T}from"./vue-vendor-BzDj5Url.js";const g=r({name:"mobileMenuForm"}),x=Object.assign(g,{emits:{successful:null},setup(r,{expose:g,emit:x}){const w=i(!1),C=x,E=i();let U=i();const A=i([0]),I=i([]),M=i({}),j=i(""),k=i(!1),L=i([]),O=i([]),S=[{label:"目录",value:"CATALOG"},{label:"菜单",value:"MENU"},{label:"内链",value:"IFRAME"},{label:"外链",value:"LINK"}],F=()=>{E.value.resetFields(),M.value={},w.value=!1},G=e=>{e&&E.value.clearValidate("icon"),M.value.icon=e},N={parentId:[t("请选择上级")],title:[t("请输入名称")],path:[t("请输入界面路径")],icon:[t("请选择图标")],color:[t("请选择颜色")],regType:[t("请选择规则类型")],status:[t("请选择可用状态")]},B=()=>{E.value.validate().then(()=>{k.value=!0;const e=K(d(M.value));o.mobileMenuSubmitForm(e,e.id).then(()=>{F(),C("successful")}).finally(()=>{k.value=!1})}).catch(()=>{})},K=e=>{if(e.module=j.value,"CATALOG"===e.menuType){const l=new a;e.path||(e.path=l.generate())}return e};return g({onOpen:(e,a)=>{if(!a)return void s.warning("请先添加菜单所属模块");if(j.value=a,w.value=!0,M.value={regType:"YES",status:"ENABLE",category:"MENU",menuType:"MENU",color:"#1677FF",sortCode:99},e){let l=d(e);M.value=Object.assign({},l)}const t={module:a};o.mobileMenuTreeSelector(t).then(e=>{I.value=[{id:0,parentId:"-1",title:"顶级",children:e}]}),L.value=l.dictList("MOBILE_REG_TYPE"),O.value=l.dictList("MOBILE_STATUS")}}),(l,a)=>{const t=p("a-tree-select"),s=p("a-form-item"),d=p("a-col"),r=p("a-input"),i=p("a-radio-group"),g=p("question-circle-outlined"),x=p("a-tooltip"),C=p("a-button"),j=p("a-input-number"),K=p("a-row"),R=p("a-form"),D=e;return m(),c(D,{title:_(M).id?"编辑移动端菜单":"增加移动端菜单",width:700,visible:_(w),"destroy-on-close":!0,onClose:F},{footer:v(()=>[f(C,{class:"xn-mr8",onClick:F},{default:v(()=>a[14]||(a[14]=[h("关闭")])),_:1}),f(C,{type:"primary",onClick:B,loading:_(k)},{default:v(()=>a[15]||(a[15]=[h("保存")])),_:1},8,["loading"])]),default:v(()=>[f(R,{ref_key:"formRef",ref:E,model:_(M),rules:N,layout:"vertical"},{default:v(()=>[f(K,{gutter:16},{default:v(()=>[f(d,{span:12},{default:v(()=>[f(s,{label:"上级菜单：",name:"parentId"},{default:v(()=>[f(t,{value:_(M).parentId,"onUpdate:value":a[0]||(a[0]=e=>_(M).parentId=e),treeExpandedKeys:_(A),"onUpdate:treeExpandedKeys":a[1]||(a[1]=e=>y(A)?A.value=e:null),class:"xn-wd","dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择上级菜单","allow-clear":"","tree-default-expand-all":"","tree-data":_(I),"field-names":{children:"children",label:"title",value:"id"},selectable:"false","tree-line":"",onChange:a[2]||(a[2]=e=>(e=>{if(e>0){const l={id:e};o.mobileMenuDetail(l).then(e=>{M.value.module=e.module})}else M.value.module=null})(_(M).parentId))},null,8,["value","treeExpandedKeys","tree-data"])]),_:1})]),_:1}),f(d,{span:12},{default:v(()=>[f(s,{label:"名称：",name:"title"},{default:v(()=>[f(r,{value:_(M).title,"onUpdate:value":a[3]||(a[3]=e=>_(M).title=e),placeholder:"请输入名称","allow-clear":""},null,8,["value"])]),_:1})]),_:1}),f(d,{span:12},{default:v(()=>[f(s,{label:"菜单类型：",name:"menuType"},{default:v(()=>[f(i,{value:_(M).menuType,"onUpdate:value":a[4]||(a[4]=e=>_(M).menuType=e),"button-style":"solid",options:S,"option-type":"button"},null,8,["value"])]),_:1})]),_:1}),"CATALOG"!==_(M).menuType?(m(),c(d,{key:0,span:12},{default:v(()=>[f(s,{name:"path"},{label:v(()=>[f(x,null,{title:v(()=>a[12]||(a[12]=[h(" 类型为内外链时，输入https开头的链接即可（例：https://xiaonuo.vip） ")])),default:v(()=>[f(g)]),_:1}),h("   "+T("MENU"===_(M).menuType||"CATALOG"===_(M).menuType?"界面地址":"https链接地址")+"： ",1)]),default:v(()=>[f(r,{value:_(M).path,"onUpdate:value":a[5]||(a[5]=e=>_(M).path=e),placeholder:"请输入","allow-clear":""},null,8,["value"])]),_:1})]),_:1})):b("",!0),f(d,{span:12},{default:v(()=>[f(s,{label:"图标：",name:"icon"},{default:v(()=>[f(r,{value:_(M).icon,"onUpdate:value":a[6]||(a[6]=e=>_(M).icon=e),class:"xn-wdcalc-70",placeholder:"请选择图标","allow-clear":"",disabled:""},null,8,["value"]),f(C,{type:"primary",onClick:a[7]||(a[7]=e=>_(U).showIconModal(_(M).icon))},{default:v(()=>a[13]||(a[13]=[h("选择")])),_:1})]),_:1})]),_:1}),f(d,{span:12},{default:v(()=>[f(s,{label:"颜色：",name:"color"},{default:v(()=>[f(n,{value:_(M).color,"onUpdate:value":a[8]||(a[8]=e=>_(M).color=e)},null,8,["value"])]),_:1})]),_:1}),f(d,{span:12},{default:v(()=>[f(s,{label:"是否正规则：",name:"regType"},{default:v(()=>[f(i,{value:_(M).regType,"onUpdate:value":a[9]||(a[9]=e=>_(M).regType=e),placeholder:"请选择正规则",options:_(L)},null,8,["value","options"])]),_:1})]),_:1}),f(d,{span:12},{default:v(()=>[f(s,{label:"可用状态：",name:"status"},{default:v(()=>[f(i,{value:_(M).status,"onUpdate:value":a[10]||(a[10]=e=>_(M).status=e),placeholder:"请选择可用状态",options:_(O)},null,8,["value","options"])]),_:1})]),_:1}),f(d,{span:12},{default:v(()=>[f(s,{label:"排序码：",name:"sortCode"},{default:v(()=>[f(j,{class:"xn-wd",value:_(M).sortCode,"onUpdate:value":a[11]||(a[11]=e=>_(M).sortCode=e),placeholder:"请输入排序码",max:1e3},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),f(u,{ref_key:"iconSelector",ref:U,onIconCallBack:G},null,512)]),_:1},8,["title","visible"])}}});export{x as default};
