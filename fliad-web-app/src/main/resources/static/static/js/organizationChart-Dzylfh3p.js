import{d as e,f as n,l as t,q as o,A as a,r as l,c as d,o as r,j as s,w as u,D as c,n as i,v as p,b as f,ap as m,Y as v,U as g,V as y,Z as h,a3 as b,ag as x,X as $,_ as N,a1 as S,a6 as z,k as D,a8 as E,a2 as C,E as M,F as k,W as O,am as _,m as w,u as R}from"./vue-vendor-BzDj5Url.js";import{_ as F,c as A}from"./index-DcffTgQN.js";import"./ant-design-vendor-CRFwT3Wn.js";const B=function(e){return"[object Object]"===Object.prototype.toString.call(e)},L=function(e){return"string"==typeof e},T=function(e){return"number"==typeof e},j={print:(e,n,t)=>L(n)||"boolean"==typeof t,pretty:(e,n,t)=>L(n)&&L(e)||"string"==typeof t,primary:(e,n)=>L(e)||"boolean"==typeof n,success:(e,n)=>L(e)||"boolean"==typeof n,info:(e,n)=>L(e)||"boolean"==typeof n,warning:(e,n)=>L(e)||"boolean"==typeof n,danger:(e,n)=>L(e)||"boolean"==typeof n};j.print=function(e,n="default",t=!1){return!0},j.pretty=function(e,n,t="primary"){return!0},j.primary=function(e,n=!1){return this.print&&this.print(e,"primary",n),!0},j.success=function(e,n=!1){return this.print&&this.print(e,"success",n),!0},j.info=function(e,n=!1){return this.print&&this.print(e,"info",n),!0},j.warning=function(e,n=!1){return this.print&&this.print(e,"warning",n),!0},j.danger=function(e,n=!1){return this.print&&this.print(e,"danger",n),!0};const Y=function(){let e=!1;return{get:()=>e,set:n=>{e=n}}}(),X=function(e,n,t){const{id:o,children:a}=n;if(e[o]===t)return e;if(Array.isArray(e[a])){const o=e[a];for(let e=0,a=o.length;e<a;e++){const a=o[e],l=X(a,n,t);if(l)return l}}},V=function(e,n){const{parenNode:t,onlyOneNode:o,cloneNodeDrag:a}=n;if(t.value){const{keys:l}=n,{id:d,pid:r,children:s}=l,u=t.value.$$data,c=JSON.parse(JSON.stringify(e.$$data));a?(function(e,n){const{children:t}=n;if(B(e))o(e);else if(Array.isArray(e))for(let a=0,l=e.length;a<l;a++)o(e[a]);function o(e){if(function(e){"string"==typeof e[d]&&-1!==e[d].indexOf("clone-node")&&(e[d]=`clone-node-${e[d]}`)}(e),Array.isArray(e[t])){const n=e[t];for(let e=0,t=n.length;e<t;e++)o(n[e])}}}(c,l),o&&Array.isArray(c[s])&&(c[s]=[]),c[l.pid]=u[l.id],u[s]?u[s].push(c):u[s]=[c]):(function(e,n){const{keys:t,data:o,onlyOneNode:a}=n,{id:l,pid:d,children:r}=t,s=X(o,t,e[d]),u=s[r];let c;for(let p=0,f=u.length;p<f;p++)if(u[p][l]===e[l]){u.splice(p,1),c=p;break}const i=e[r];a&&void 0!==c&&i&&(e[r]=[],i.forEach(e=>{e[d]=s[l]}),s[r].splice(c,0,...i))}(c,n),c[r]=u[d],u[s]?u[s].push(c):u[s]=[].concat(c))}},P={beforeMount(e,n){const{l:t,t:o}=n.modifiers,{drag:a,dragData:l,node:d,emit:r,beforeDragEnd:s,initNodes:u}=n.value,{value:c}=n,i={...l};e.addEventListener("mousedown",function(e){const n=e.target;if(!1===a||0!==e.button||d.focused||d.$$data.noDragging||n.className.indexOf("tree-org-node-btn")>-1)return!1;(function(e){e.stopPropagation(),v=e.screenX,g=e.screenY,f=0,i.contextmenu.value=!1;const{keys:n,onlyOneNode:t}=i;if(t){const{children:e}=n,t={...d.$$data};t[e]=[],i.cloneData.value=u(t)}else i.cloneData.value=u(d.$$data)})(e),document.addEventListener("mousemove",y),document.addEventListener("mouseup",h),x("start")});let p,f=0,m=!1,v=0,g=0;function y(n){return n.preventDefault(),!(Math.abs(n.screenX-v)<5&&Math.abs(n.screenY-g)<5)&&(m||(m=!0,function(n){Y.set(!0),i.nodeMoving.value=!0,d.moving=!0;let t=e;for(;!t.classList.contains("tree-org-node");)f+=t.offsetLeft,t=t.offsetParent;f+=2,p=document.querySelector("#clone-tree-org"),p&&(p.style.width=`${t.clientWidth}px`,p.style.opacity="0.8",p.style.left=n.clientX-f+"px",p.style.top=n.clientY+2+"px")}(n)),t&&o&&c?(p&&(p.style.left=n.clientX-f+"px",p.style.top=n.clientY+2+"px"),void x("move")):t&&c?(e.style.left=n.clientX-f+"px",void x("move")):void(o&&c&&(e.style.top=n.clientY+"px",x("move"))))}function h(e){if(document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",h),m){if("function"==typeof s){const n=s(d,i.parenNode.value);n&&n.then?n.then(()=>{b(e)},()=>{}):!1!==n&&b(e)}else b(e);m=!1,p=null,d.moving=!1,i.nodeMoving.value=!1,setTimeout(()=>{Y.set(!1)},200)}}function b(e){const n=document.querySelector(".tree-org-node__moving");if(n&&n.contains(e.target))return x("end"),!1;V(d,i),x("end")}function x(e){"start"!==e?"move"!==e?"end"===e&&r("on-node-drag-end",d,i.parenNode.value):r("on-node-drag",d):r("on-node-drag-start",d)}}},W={onClick:"onNodeClick",onDblclick:"onNodeDblclick",onContextmenu:"onNodeContextmenu",onMouseenter:"onNodeMouseenter",onMouseleave:"onNodeMouseleave"};function q(e,n){if("function"==typeof e)return function(t){t.target.className.indexOf("org-tree-node-btn")>-1||e(t,n)}}const K=(e,n,t)=>!(Array.isArray(e[n])&&e[n].length>0)&&!t||e.isLeaf,U=(e,n,t)=>{const{attrs:l}=t,d=["tree-org-node"],r=[],{expand:s,children:u,id:c}=n;return K(n,"children",l.lazy)?d.push("is-leaf"):l.collapsable&&!s&&d.push("collapsed"),n.moving&&d.push("tree-org-node__moving"),r.push(I(e,n,t)),l.collapsable&&!s||r.push(J(e,u,t)),o(e("div",{class:d,key:c},r),[[a,!n.hidden]])},I=(e,n,t)=>{const{attrs:l}=t,d=l.props,r=l.renderContent,{label:s}=n,u=[];if(t.slots.default)u.push(t.slots.default({node:n}));else if("function"==typeof r){j.warning("scoped-slot header is easier to use. We recommend users to use scoped-slot header.");const t=r(e,n);t&&u.push(t)}else u.push(e("div",{class:"tree-org-node__text"},s));l.collapsable&&!K(n,"children",l.lazy)&&u.push(((e,n,t)=>{const{attrs:o}=t,a=o.onOnExpand,l=["tree-org-node__expand"];n.expand&&l.push("expanded");const d=[];return t.slots.expand?d.push(t.slots.expand({node:n})):d.push(e("span",{class:"tree-org-node__expand-btn"})),e("span",{class:l,onMousedown:e=>{e.stopPropagation()},onDblclick:e=>{e.stopPropagation()},onClick:e=>{e.stopPropagation(),a&&a(e,n)}},d)})(e,n,t));const c=["tree-org-node__inner"];let{labelStyle:i,labelClassName:f,selectedClassName:m,selectedKey:v}=l;"function"==typeof f&&(f=f(n)),f&&c.push(f),n.className&&c.push(n.className),"function"==typeof m&&(m=m(n)),void 0!==v&&(v=Array.isArray(v)?v:[v]),m&&v&&v.includes(n.id)&&c.push(m);const g=["tree-org-node__content"];n.$$root&&g.push(`is-root_${l.suffix}`),n.label||g.push("is-empty"),n.$$focused&&g.push("is-edit");const y=p("nodedrag"),h=[];l.vNodedrag&&y&&!n.$$root&&h.push([y,Object.assign({node:n},l.vNodedrag),"",{l:!0,t:!0}]);const b={};for(const o in W)if(Object.prototype.hasOwnProperty.call(W,o)){const e=l[W[o]];e&&(b[o]=q(e,n))}const x=l.onNodeFocus,$=l.onNodeBlur,N=p("focus"),S=[[a,n.$$focused]];return N&&S.push([N,n.$$focused]),e("div",{class:g},[o(e("div",{class:c,style:n.style?n.style:i,...b},u),h),o(e("textarea",{class:"tree-org-node__textarea",placeholder:"请输入节点名称",value:n.label,onFocus:e=>{x&&x(e,n.$$data,n)},onInput:e=>{n.label=e.target.value},onBlur:e=>{void 0!==n.$$data.focused&&(n.$$data.focused=!1),n.$$data[d.label]=e.target.value,n.$$focused=!1,$&&$(e,n.$$data,n)},onClick:e=>e.stopPropagation()}),S)])},J=(e,n,t)=>{if(Array.isArray(n)&&n.length){const o=n.filter(e=>!e.$$hidden).map(n=>U(e,n,t));return e("div",{class:"tree-org-node__children"},o)}return""},H=(e,n)=>e.data&&0!==Object.keys(e.data).length?(e.data.$$root=!e.isClone,U(t,e.data,n)):"";H.directives={focus:{mounted(e,{value:n}){n&&e.focus()},updated(e,{value:n}){n&&e.focus()}},nodedrag:P};var Z=e({props:{scale:String,tools:Object},setup(e,{emit:t}){const o=n(!1),a=n(!1);function l(e){a.value=!a.value,t("onFullscreen",e)}function u(){document.isFullScreen||document.mozIsFullScreen||document.webkitIsFullScreen||!a.value||l("esc")}const c=d(()=>o.value?"全部收起":"全部展开"),i=d(()=>a.value?"退出全屏":"全屏");return r(()=>{window.addEventListener("resize",u)}),s(()=>{window.removeEventListener("resize",u)}),{expanded:o,fullscreen:a,expandTitle:c,fullTiltle:i,handleExpand:function(){o.value=!o.value,t("onExpand")},handleScale:function(e){"out"===e?t("onScale",.1):"in"===e?t("onScale",-.1):t("onRestore")},handleFullscreen:l}}});const G={class:"zm-tree-handle"},Q={key:0,class:"zm-tree-percent"},ee=["title"],ne={class:"zm-tree-svg"},te=[v("span",{class:"zm-tree-icon"},"+",-1)],oe=[v("span",{class:"zm-tree-icon"},"-",-1)],ae=[v("span",{class:"zm-tree-restore"},null,-1)],le=["title"],de={class:"zm-tree-svg"};function re(e){return"function"==typeof e||"[object Function]"===Object.prototype.toString.call(e)}function se(e,n,t,o=1){return{deltaX:Math.round(n/o/e[0])*e[0],deltaY:Math.round(t/o/e[1])*e[1]}}function ue(e,n,t){return e<n?n:t<e?t:e}Z.render=function(e,n,t,o,a,l){return y(),g("div",G,[e.tools.scale?(y(),g("div",Q,b(e.scale),1)):h("v-if",!0),e.tools.expand?(y(),g("div",{key:1,onClick:n[0]||(n[0]=(...n)=>e.handleExpand&&e.handleExpand(...n)),title:e.expandTitle,class:"zm-tree-handle-item"},[v("span",ne,[v("i",{class:x(["treefont",e.expanded?"icon-collapse":"icon-expand"])},null,2)])],8,ee)):h("v-if",!0),e.tools.zoom?(y(),g("div",{key:2,onClick:n[1]||(n[1]=n=>e.handleScale("out")),title:"放大",class:"zm-tree-handle-item zoom-out"},te)):h("v-if",!0),e.tools.zoom?(y(),g("div",{key:3,onClick:n[2]||(n[2]=n=>e.handleScale("in")),title:"缩小",class:"zm-tree-handle-item zoom-in"},oe)):h("v-if",!0),e.tools.restore?(y(),g("div",{key:4,onClick:n[3]||(n[3]=n=>e.handleScale("restore")),title:"还原",class:"zm-tree-handle-item"},ae)):h("v-if",!0),e.tools.fullscreen?(y(),g("div",{key:5,onClick:n[4]||(n[4]=(...n)=>e.handleFullscreen&&e.handleFullscreen(...n)),title:e.fullTiltle,class:"zm-tree-handle-item"},[v("span",de,[v("i",{class:x(["treefont",e.fullscreen?"icon-unfullscreen":"icon-fullscreen"])},null,2)])],8,le)):h("v-if",!0)])},Z.__file="src/components/tools/tools.vue";const ce=function(e,n,t,o=!1){e&&n&&t&&e.addEventListener(n,t,o)},ie=function(e,n,t,o=!1){e&&n&&t&&e.removeEventListener(n,t,o)},pe=Symbol("wrapper");function fe(e,n){if(null===(t=e)||"object"!=typeof t||e.__elPropsReservedKey)return e;var t;const{values:o,required:a,default:l,type:d,validator:r}=e,s=o||r?e=>{let t=!1,a=[];if(o&&(a=[...o,l],t=t||a.includes(e)),r&&(t=t||r(e)),!t&&a.length>0){const t=[...new Set(a)].map(e=>JSON.stringify(e)).join(", ");m(`Invalid prop: validation failed${n?` for prop "${n}"`:""}. Expected one of [${t}], got value ${JSON.stringify(e)}.`)}return t}:void 0;return{type:"object"==typeof d&&Object.getOwnPropertySymbols(d).includes(pe)?d[pe]:d,validator:s,__elPropsReservedKey:!0,default:l,required:!!a}}const me=e=>function(e){let n=-1;const t=e?e.length:0,o={};for(;++n<t;){const t=e[n];o[t[0]]=t[1]}return o}(Object.entries(e).map(([e,n])=>[e,fe(n,e)])),ve=e=>({[pe]:e});var ge=e({replace:!0,name:"Draggable",props:me({className:{type:String,default:"zm-draggable"},classNameDraggable:{type:String,default:"draggable"},classNameDragging:{type:String,default:"dragging"},classNameActive:{type:String,default:"active"},disableUserSelect:{type:Boolean,default:!0},enableNativeDrag:{type:Boolean,default:!1},preventDeactivation:{type:Boolean,default:!1},active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},x:{type:Number,default:0},y:{type:Number,default:0},z:{type:[String,Number],default:"auto",validator:e=>"string"==typeof e?"auto"===e:e>=0},dragCancel:String,axis:{type:String,default:"both",validator:e=>["x","y","both"].includes(e)},grid:{type:Array,default:()=>[1,1]},parent:{type:Boolean,default:!1},scale:{type:Number,default:1,validator:e=>e>0}}),emits:{activated:()=>!0,deactivated:()=>!0,dragging:(e,n)=>T(e)&&T(n),dragstop:(e,n)=>T(e)&&T(n),"update:active":e=>"boolean"==typeof e},setup(e,t){const o=n(),a=((e,{emit:t},o)=>{const a={start:"mousedown",move:"mousemove",stop:"mouseup"},l={start:"touchstart",move:"touchmove",stop:"touchend"},s={userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none"},i={userSelect:"auto",MozUserSelect:"auto",WebkitUserSelect:"auto",MsUserSelect:"auto"};let p=a;const m=n(e.x),v=n(e.y),g=n(e.z),y=n(e.active),h=n(!1),b=n(0),x=n(0),$=n(0),N=n(0),S=n(0),z=n(0);let D={},E={};function C(){D={mouseX:0,mouseY:0,x:0,y:0,w:0,h:0},E={minLeft:-1/0,maxLeft:1/0,minRight:-1/0,maxRight:1/0,minTop:-1/0,maxTop:1/0,minBottom:-1/0,maxBottom:1/0}}function M(){if(e.parent){const[e,n]=k();S.value=e||0,z.value=n||0}}function k(){if(e.parent&&o.eleRef.value){const e=window.getComputedStyle(o.eleRef.value.parentNode,null);return[parseInt(e.getPropertyValue("width"),10),parseInt(e.getPropertyValue("height"),10)]}return[0,0]}function O(n){if(n instanceof MouseEvent&&1!==n.which)return;const a=n.target||n.srcElement;if(a&&o.eleRef.value&&o.eleRef.value.contains(a)){if(e.dragCancel&&function(e,n,t){let o=e;const a=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(e=>o&&re(o[e]))||"";if(!re(o[a]))return!1;do{if(o[a](n))return!0;if(o===t)return!1;o=o.parentNode}while(o);return!1}(a,e.dragCancel,o.eleRef.value))return void(h.value=!1);y.value||(y.value=!0,t("activated"),t("update:active",!0)),e.draggable&&(h.value=!0),n instanceof MouseEvent?(D.mouseX=n.pageX,D.mouseY=n.pageY):(D.mouseX=n.touches[0].pageX,D.mouseY=n.touches[0].pageY),D.left=m.value,D.right=b.value,D.top=v.value,D.bottom=x.value,e.parent&&(E=_()),ce(document.documentElement,p.move,R),ce(document.documentElement,p.stop,F)}}function _(){const n=e.grid;return{minLeft:m.value%n[0],maxLeft:Math.floor((S.value-$.value-m.value)/n[0])*n[0]+m.value,minRight:b.value%n[0],maxRight:Math.floor((S.value-$.value-b.value)/n[0])*n[0]+b.value,minTop:v.value%n[1],maxTop:Math.floor((z.value-N.value-v.value)/n[1])*n[1]+v.value,minBottom:x.value%n[1],maxBottom:Math.floor((z.value-N.value-x.value)/n[1])*n[1]+x.value}}function w(n){const a=n.target||n.srcElement;o.eleRef.value&&!o.eleRef.value.contains(a)&&y.value&&!e.preventDeactivation&&(y.value=!1,t("deactivated"),t("update:active",!1))}function R(n){h.value&&function(n){const o=e.axis,a=e.grid;let l=0,d=0;n instanceof MouseEvent?(l=n.pageX,d=n.pageY):(l=n.touches[0].pageX,d=n.touches[0].pageY);const r=o&&"y"!==o?D.mouseX-l:0,s=o&&"x"!==o?D.mouseY-d:0,{deltaX:u,deltaY:c}=se(a,r,s,e.scale),i=ue(D.left-u,E.minLeft,E.maxLeft),p=ue(D.top-c,E.minTop,E.maxTop),f=ue(D.right+u,E.minRight,E.maxRight),g=ue(D.bottom+c,E.minBottom,E.maxBottom);m.value=i,v.value=p,b.value=f,x.value=g,t("dragging",m.value,v.value)}(n)}function F(){C(),h.value&&(h.value=!1,t("dragstop",m.value,v.value))}c(()=>{C()}),r(()=>{!e.enableNativeDrag&&o.eleRef.value&&(o.eleRef.value.ondragstart=()=>!1);const[n,t]=k();if(S.value=n,z.value=t,o.eleRef.value){const[e,n]=function(e){const n=window.getComputedStyle(e);return[parseFloat(n.getPropertyValue("width")),parseFloat(n.getPropertyValue("height"))]}(o.eleRef.value);$.value=e,N.value=n,b.value=S.value-$.value-m.value,x.value=z.value-N.value-v.value}ce(document.documentElement,"mousedown",w),ce(document.documentElement,"touchend touchcancel",w),ce(window,"resize",M)}),f(()=>{ie(document.documentElement,"mousedown",w),ie(document.documentElement,"touchstart",F),ie(document.documentElement,"mousemove",R),ie(document.documentElement,"touchmove",R),ie(document.documentElement,"mouseup",F),ie(document.documentElement,"touchend touchcancel",w),ie(window,"resize",M)});const A=d(()=>({transform:`translate(${m.value}px, ${v.value}px)`,zIndex:g.value,...h.value&&e.disableUserSelect?s:i}));return u(()=>e.active,e=>{y.value=e,t(e?"activated":"deactivated")}),u(()=>e.z,e=>{(e>=0||"auto"===e)&&(g.value=e)}),u(()=>e.x,n=>{h.value||(e.parent&&(E=_()),function(n){const{deltaX:t}=se(e.grid,n,v.value,e.scale),o=ue(t,E.minLeft,E.maxLeft);m.value=o,b.value=S.value-$.value-o}(n))}),u(()=>e.y,n=>{h.value||(e.parent&&(E=_()),function(n){const{deltaY:t}=se(e.grid,m.value,n,e.scale),o=ue(t,E.minTop,E.maxTop);v.value=o,x.value=z.value-N.value-o}(n))}),{enabled:y,dragging:h,style:A,resetBoundsAndMouseState:C,elementTouchDown:function(e){p=l,O(e)},elementMouseDown:function(e){p=a,O(e)}}})(e,t,{eleRef:o});return{top:top,eleRef:o,...a}}});ge.render=function(e,n,t,o,a,l){return y(),g("div",{style:N(e.style),class:x([{[e.classNameActive]:e.enabled,[e.classNameDragging]:e.dragging,[e.classNameDraggable]:e.draggable},e.className]),ref:"eleRef",onMousedown:n[0]||(n[0]=(...n)=>e.elementMouseDown&&e.elementMouseDown(...n)),onTouchstart:n[1]||(n[1]=(...n)=>e.elementTouchDown&&e.elementTouchDown(...n))},[$(e.$slots,"default")],38)},ge.__file="src/components/draggable/src/draggable.vue";var ye=e({components:{TreeOrgNode:H},props:me({data:{type:Object,required:!0},props:{type:ve(Object)},modelValue:Boolean,horizontal:Boolean,selectedKey:String,collapsable:Boolean,renderContent:Function,labelStyle:Object,labelClassName:{type:[Function,String]}}),setup:(e,n)=>({defaultSlot:!!n.slots.default,expandSlot:!!n.slots.expand})});ye.render=function(e,n,t,l,d,r){const s=S("tree-org-node");return y(),z(M,{to:"body"},[o(v("div",{id:"clone-tree-org",class:x(["clone-tree-org tree-org",{horizontal:e.horizontal,collapsable:e.collapsable}])},[D(s,{data:e.data,props:e.props,isClone:!1,horizontal:e.horizontal,labelStyle:e.labelStyle,collapsable:e.collapsable,renderContent:e.renderContent,labelClassName:e.labelClassName},E({_:2},[e.defaultSlot?{name:"default",fn:C(({node:n})=>[$(e.$slots,"default",{node:n})])}:void 0,e.expandSlot?{name:"expand",fn:C(({node:n})=>[$(e.$slots,"expand",{node:n})])}:void 0]),1032,["data","props","horizontal","labelStyle","collapsable","renderContent","labelClassName"])],2),[[a,e.modelValue]])])},ye.__file="src/components/clone-org/clone-org.vue";const he=(e,{emit:t},o)=>{const a=n("");function l(e,n,t){if(e[n.id]===t)return e;if(Array.isArray(e[n.children])){const o=e[n.children];for(let e=0,a=o.length;e<a;e++){const a=l(o[e],n,t);if(a)return a}}}function s(){const{props:n,data:o,node:a}=e;if(e.nodeDelete)return void e.nodeDelete(a.$$data);if(a.$$root)return void j.pretty("[提示] ","根节点不允许删除","danger");const{id:d,children:r}=n,s=l(o,n,a.pid);if(s){const e=s[r];for(let n=0,o=e.length;n<o;n++)if(e[n][d]===a.id){e.splice(n,1),t("onNodeDelete",a.$$data,a);break}}}function u(){const{nodeEdit:n,node:o}=e;n?n(o.$$data):(o.$$focused=!0,t("onNodeFocus",o.$$data))}function c(n){if(e.modelValue){if(o.eleRef.value&&o.eleRef.value.contains(n.target))return!1;t("update:modelValue",!1)}}const p=d(()=>({left:`${e.x}px`,top:`${e.y}px`})),m=d(()=>!e.disabled&&!e.node.disabled);return r(()=>{document.addEventListener("mousedown",c)}),f(()=>{document.removeEventListener("mousedown",c)}),{position:p,editable:m,handleMenu:function(n){const l=n.target;if("zm-tree-menu-item"===l.className){const n=l.getAttribute("action");switch(n){case"copy":e.nodeCopy?e.nodeCopy(e.node.$$data):(a.value=e.node.label,i(()=>{o.inputRef&&o.inputRef.value&&(o.inputRef&&o.inputRef.value.select(),navigator.clipboard.writeText(a.value).then(function(){j.pretty("[提示] ","文本复制成功","success")},function(){j.pretty("[错误] ","浏览器不支持","danger")}),t("onNodeCopy",a.value))}));break;case"add":!function(){if(e.nodeAdd)return void e.nodeAdd(e.node.$$data);const{id:n,pid:o,label:a,expand:l,children:d}=e.props,{node:r}=e,s={[n]:String((new Date).getTime()),[o]:r.id,[a]:"",[l]:!1,[d]:[],newNode:!0,focused:!0};Array.isArray(r.children)?r.$$data[d].push(s):r.$$data[d]=[s],t("onNodeFocus",s)}();break;case"edit":u();break;case"delete":s()}t("contextmenu",{command:n,node:e.node,data:e.node.$$data}),t("update:modelValue",!1)}},handleEdit:u,handleClose:c,afterEnter:function(){t("opened")},afterLeave:function(){t("closed")}}};var be=e({name:"Contextmenu",props:me({modelValue:{type:Boolean,required:!0},data:{type:Object,required:!0},node:{type:ve(Object),required:!0},props:{type:ve(Object)},x:Number,y:Number,menus:{type:ve(Array)},nodeAdd:Function,nodeDelete:Function,nodeEdit:Function,nodeCopy:Function,disabled:Boolean}),emits:{onNodeDelete:(e,n)=>B(e)&&B(n),onNodeCopy:e=>L(e),contextmenu:e=>B(e),onNodeFocus:e=>B(e),opened:()=>!0,closed:()=>!0,"update:modelValue":e=>"boolean"==typeof e},setup(e,t){const o=n(),a=n();return{eleRef:a,inputRef:o,copyText:n(""),oldData:l({}),...he(e,t,{inputRef:o,eleRef:a})}}});const xe=["action"];be.render=function(e,n,t,l,d,r){return y(),z(M,{to:"body"},[D(w,{name:"dialog-fade",onAfterEnter:e.afterEnter,onAfterLeave:e.afterLeave,persisted:""},{default:C(()=>[o(v("div",{style:N(e.position),onClick:n[1]||(n[1]=(...n)=>e.handleMenu&&e.handleMenu(...n)),ref:"eleRef",class:"zm-tree-contextmenu"},[v("ul",null,[(y(!0),g(k,null,O(e.menus,n=>(y(),g(k,null,[e.editable||!["add","edit","delete"].includes(n.command)?(y(),g("li",{class:"zm-tree-menu-item",action:n.command,key:n.command},b(n.name),9,xe)):h("v-if",!0)],64))),256))]),o(v("textarea",{class:"copy-textarea",ref:"inputRef","onUpdate:modelValue":n[0]||(n[0]=n=>e.copyText=n)},null,512),[[_,e.copyText]])],4),[[a,e.modelValue]])]),_:1},8,["onAfterEnter","onAfterLeave"])])},be.__file="src/components/contextmenu/src/contextmenu.vue";const $e=[{name:"复制文本",command:"copy"},{name:"新增节点",command:"add"},{name:"编辑节点",command:"edit"},{name:"删除节点",command:"delete"}],Ne=me({data:{type:Object,required:!0},center:Boolean,props:{type:ve(Object),default:()=>({id:"id",pid:"pid",label:"label",expand:"expand",children:"children"})},toolBar:{type:[Object,Boolean],default:()=>({expand:!0,scale:!0,zoom:!0,restore:!0,fullscreen:!0})},disabled:{type:Boolean,default:!1},scalable:{type:Boolean,default:!0},draggable:{type:Boolean,default:!0},draggableOnNode:{type:Boolean,default:!1},nodeDraggable:{type:Boolean,default:!0},cloneNodeDrag:{type:Boolean,default:!0},onlyOneNode:{type:Boolean,default:!0},clickDelay:{type:Number,default:260},lazy:Boolean,load:{type:ve(Function)},defaultExpandLevel:Number,defaultExpandKeys:{type:Array,default:()=>[]},beforeDragEnd:Function,horizontal:Boolean,selectedKey:{type:[Array,String,Number]},collapsable:Boolean,renderContent:Function,labelStyle:Object,labelClassName:{type:[Function,String]},selectedClassName:{type:[Function,String]},defineMenus:{type:ve([Array,Function]),default:()=>$e},nodeAdd:Function,nodeDelete:Function,nodeEdit:Function,nodeCopy:Function,filterNodeMethod:Function}),Se=(e,{emit:t},o)=>{const a=n(0),r=n(0),s=n(!1);function p(n,t){const l=o.zoomRef.value,d=o.treeRef.value;let s=l.clientWidth/2;const u=l.clientHeight/2;let c=l.clientHeight-d.clientHeight,i=l.clientWidth-d.clientWidth;if(c>0&&(c=0),i>0&&(i=0),e.center){const e=(l.clientWidth-d.clientWidth)/2;i-=e,s-=e}a.value=n>s?s:n<i?i:n,r.value=t<c?c:t>u?u:t}function f(e,n){p(e,n),setTimeout(()=>{Y.set(!1)},200),t("on-drag-stop",{x:e,y:n})}const m=n(!1),v=l({value:{}}),g=n(!1),y=n(0),h=n(0),b=n({}),x=n([]),$=n(1);function N(n){if(!e.scalable)return;const t=Number((Number($.value)+n).toFixed(1));$.value=n>0?Math.min(3,t):Math.max(.3,t)}function S(n,t,o){if(s.value=!0,!e.center||e.horizontal){const e=n.offsetLeft-t;a.value-=e}const l=n.offsetTop-o;r.value-=l,p(a.value,r.value)}let z;const D=l(Object.assign({id:"id",pid:"pid",label:"label",expand:"expand",children:"children",isLeaf:"isLeaf"},e.props)),E=n(!1);function C(e){e.forEach(e=>{e.expand&&(e.expand=!1,T.delete(e.id)),e.children&&C(e.children)})}const M=n(!1);function k(e,n){Array.isArray(e)?e.forEach(e=>{n&&T.add(e.id),e.expand=n,n&&T.add(e.id),e.children&&k(e.children,n)}):(n&&T.add(e.id),e.expand=n,n&&T.add(e.id),e.children&&k(e.children,n))}function O(e){X.value=j(e)}const _=d(()=>({width:100/$.value+"%",height:100/$.value+"%",transform:`scale(${$.value})`})),w=d(()=>`${Math.round(100*$.value)}%`),R=d(()=>e.draggableOnNode&&!e.nodeDraggable?"":`.tree-org-node__content:not(.is-root_${P})>.tree-org-node__inner`),F=d(()=>M.value?"收起全部节点":"展开全部节点"),A=d(()=>M.value?"收起全部节点":"展开全部节点"),B=n({}),L=d(()=>{const{cloneNodeDrag:n,onlyOneNode:o,data:a}=e;return{drag:e.nodeDraggable,dragData:{keys:D,nodeMoving:m,stopClick:Y,parenNode:v,cloneNodeDrag:n,onlyOneNode:o,contextmenu:g,cloneData:B,data:a},beforeDragEnd:e.beforeDragEnd,initNodes:j,emit:t}});u(()=>e.horizontal,()=>{i(()=>{f(a.value,r.value)})});let T=new Set(e.defaultExpandKeys);function j(n){const{defaultExpandLevel:t=0}=e,o=(e,n)=>{const{id:a,label:l,pid:d,expand:r,children:s,isLeaf:u}=D,c={};Object.keys(e).map(n=>{["hidden","disabled","className","style"].includes(n)&&(c[n]=e[n])});const i=e[s],p=n+1,f=e[r],m=e[a];return(f||void 0===f&&n<t)&&T.add(m),{...c,id:m,label:e[l],pid:e[d],expand:T.has(m),children:i?i.map(e=>o(e,p)):void 0,isLeaf:e[u],$$level:n,$$data:e,$$focused:e.focused||!1}};return o(n,0)}const X=n(j(e.data));u(()=>e.data,(n,t)=>{n!==t&&(T=new Set(e.defaultExpandKeys)),O(e.data)},{deep:!0});const V=l({visible:!0,data:{expand:!0,scale:!0,zoom:!0,restore:!0,fullscreen:!0}});c(()=>{"object"==typeof e.toolBar?Object.assign(V.data,e.toolBar):e.toolBar||(V.visible=!1)});const P=function(e){e=e||32;const n="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678";let t="";for(let o=0;o<e;o++)t+=n.charAt(Math.floor(48*Math.random()));return t}(6);return{keys:D,left:a,top:r,menuX:y,menuY:h,suffix:P,nodeMoving:m,zoomStyle:_,tools:V,zoomPercent:w,dragCancel:R,expandTitle:F,fullTiltle:A,nodeargs:L,expanded:M,fullscreen:E,treeData:X,autoDragging:s,contextmenu:g,nodeMenus:x,menuData:b,cloneData:B,filter:function(n){const t=e.filterNodeMethod;if(!t)throw new Error("[Tree] filterNodeMethod is required when filter");const o=function(e){const a=e.children||[];if(a.forEach(e=>{e.$$hidden=!t.call(e,n,e),o(e)}),e.$$hidden&&a.length){let n=!0;n=a.some(e=>!e.$$hidden),e.$$hidden=!n}n&&!e.$$hidden&&e.children&&(e.expand=!0)};o(X.value)},setData:O,zoomWheel:function(n){e.scalable&&(n.preventDefault(),n.deltaY<0?N(.1):N(-.1),t("on-zoom",$.value))},onDrag:function(e,n){Y.set(!0),s.value=!1,a.value=e,r.value=n,t("on-drag",{x:e,y:n})},onDragStop:f,expandChange:function(){M.value=!M.value,M.value||(T.clear(),i(()=>{f(a.value,r.value)})),k(X.value,M.value),t("on-expand-all",M.value)},handleFullscreen:function(e){E.value=!E.value,"esc"!==e&&(E.value?function(){const e=o.eleRef.value;e.requestFullscreen&&e.requestFullscreen()}():document.exitFullscreen&&document.exitFullscreen())},zoomOrgchart:N,restoreOrgchart:function(){$.value=1,a.value=0,r.value=0,t("on-restore")},handleExpand:function(n,o){n.stopPropagation();const a=document.querySelector(`.is-root_${P}`);if(a){const d=a.offsetLeft,r=a.offsetTop;o.expand=!o.expand;let s=!0;o.expand?(T.add(o.id),e.lazy&&e.load&&(s=!1,l=o,(0,e.load)(l,(e,n)=>{const{children:t}=D;l.isLeaf=!e.length,e.length&&(l.$$data[t]=e,n&&i(()=>{S(a,d,r)}))}))):!o.expand&&o.children&&(T.delete(o.id),C(o.children)),i(()=>{s&&S(a,d,r)}),t("on-expand",n,o.$$data,o)}var l},getExpandKeys:function(){return[...T]},setExpandKeys:function(n){T=new Set(n),O(e.data)},nodeMouseenter:function(e,n){return m.value&&(v.value=n),t("on-node-mouseenter",e,n.$$data,n),!0},nodeMouseleave:function(e,n){return m.value&&(v.value=null),t("on-node-mouseleave",e,n.$$data,n),!0},nodeContextmenu:function(n,t){n.stopPropagation(),n.preventDefault();const{defineMenus:o}=e;Array.isArray(o)?x.value=o:"function"==typeof o&&(x.value=o(n,t)||[]),g.value=!0,y.value=n.clientX,h.value=n.clientY,b.value=t},handleFocus:function(e,n,o){t("on-node-focus",e,n,o)},handleBlur:function(e,n,o){const{id:a,label:l}=D,d=b.value.children||[];for(let t=d.length;t>0;t--){const e=d[t-1];if(""===e[a]&&""===e[l]){d.splice(t-1,1);break}}t("on-node-blur",e,n,o)},handleClick:function(n,o){Y.get()||(clearTimeout(z),z=setTimeout(()=>{t("on-node-click",n,o.$$data,o)},e.clickDelay))},handleDblclick:function(e,n){clearTimeout(z),t("on-node-dblclick",e,n.$$data,n)}}};var ze=e({name:"vue3TreeOrg",components:{Tools:Z,CloneOrg:ye,Draggable:ge,Contextmenu:be,TreeOrgNode:H},directives:{nodedrag:P},props:Ne,emits:{"on-drag":({x:e,y:n})=>T(e)&&T(n),"on-drag-stop":({x:e,y:n})=>T(e)&&T(n),"on-restore":()=>!0,"on-zoom":e=>T(e),"on-expand":(e,n,t)=>e instanceof MouseEvent&&B(t)&&B(n),"on-expand-all":e=>"boolean"==typeof e,"on-node-blur":(e,n,t)=>e instanceof FocusEvent&&B(t)&&B(n),"on-node-click":(e,n,t)=>e instanceof MouseEvent&&B(t)&&B(n),"on-node-dblclick":(e,n,t)=>e instanceof MouseEvent&&B(t)&&B(n),"on-node-mouseenter":(e,n,t)=>e instanceof MouseEvent&&B(t)&&B(n),"on-node-mouseleave":(e,n,t)=>e instanceof MouseEvent&&B(t)&&B(n),"on-contextmenu":e=>B(e),"on-node-copy":e=>L(e),"on-node-delete":e=>B(e),"on-node-drag-start":e=>B(e),"on-node-drag":e=>B(e),"on-node-drag-end":(e,n)=>B(e)&&B(n),"on-node-focus":(e,n,t)=>e instanceof FocusEvent&&B(t)&&B(n)},setup(e,t){const o=!!t.slots.default,a=!!t.slots.expand,l=n(),d=n(),r=n();return{eleRef:l,treeRef:d,zoomRef:r,defaultSlot:o,expandSlot:a,...Se(e,t,{eleRef:l,treeRef:d,zoomRef:r})}}});const De={ref:"eleRef",class:"zm-tree-org"},Ee={class:"tree-org-node__text"},Ce=v("span",{class:"tree-org-node__expand-btn"},null,-1),Me={class:"tree-org-node__text"},ke=v("span",{class:"tree-org-node__expand-btn"},null,-1);ze.render=function(e,n,t,o,a,l){const d=S("tree-org-node"),r=S("Draggable"),s=S("Tools"),u=S("clone-org"),c=S("Contextmenu");return y(),g("div",De,[v("div",{ref:"zoomRef",class:x(["zoom-container",{"is-center":e.center&&!e.horizontal}]),style:N(e.zoomStyle),onWheel:n[0]||(n[0]=(...n)=>e.zoomWheel&&e.zoomWheel(...n))},[D(r,{x:e.left,y:e.top,class:x({dragging:e.autoDragging}),onDragging:e.onDrag,onDragstop:e.onDragStop,draggable:e.draggable,"drag-cancel":e.dragCancel},{default:C(()=>[v("div",{ref:"treeRef",class:x(["tree-org",{horizontal:e.horizontal,collapsable:e.collapsable}])},[D(d,{data:e.treeData,props:e.keys,lazy:e.lazy,suffix:e.suffix,horizontal:e.horizontal,labelStyle:e.labelStyle,collapsable:e.collapsable,renderContent:e.renderContent,selectedKey:e.selectedKey,defaultExpandLevel:e.defaultExpandLevel,selectedClassName:e.selectedClassName,labelClassName:e.labelClassName,vNodedrag:e.nodeargs,onOnExpand:e.handleExpand,onNodeClick:e.handleClick,onNodeDblclick:e.handleDblclick,onNodeMouseenter:e.nodeMouseenter,onNodeMouseleave:e.nodeMouseleave,onNodeContextmenu:e.nodeContextmenu,onNodeFocus:e.handleFocus,onNodeBlur:e.handleBlur},E({_:2},[e.defaultSlot?{name:"default",fn:C(({node:n})=>[$(e.$slots,"default",{node:n},()=>[v("div",Ee,[v("span",null,b(n.label),1)])])])}:void 0,e.expandSlot?{name:"expand",fn:C(({node:n})=>[$(e.$slots,"expand",{node:n},()=>[Ce])])}:void 0]),1032,["data","props","lazy","suffix","horizontal","labelStyle","collapsable","renderContent","selectedKey","defaultExpandLevel","selectedClassName","labelClassName","vNodedrag","onOnExpand","onNodeClick","onNodeDblclick","onNodeMouseenter","onNodeMouseleave","onNodeContextmenu","onNodeFocus","onNodeBlur"])],2)]),_:3},8,["x","y","class","onDragging","onDragstop","draggable","drag-cancel"])],38),e.tools.visible?(y(),z(s,{key:0,tools:e.tools.data,scale:e.zoomPercent,onOnExpand:e.expandChange,onOnScale:e.zoomOrgchart,onOnRestore:e.restoreOrgchart,onOnFullscreen:e.handleFullscreen},null,8,["tools","scale","onOnExpand","onOnScale","onOnRestore","onOnFullscreen"])):h("v-if",!0),e.nodeDraggable?(y(),z(u,{key:1,modelValue:e.nodeMoving,"onUpdate:modelValue":n[1]||(n[1]=n=>e.nodeMoving=n),props:e.keys,data:e.cloneData,horizontal:e.horizontal,"label-style":e.labelStyle,collapsable:e.collapsable,"render-content":e.renderContent,"label-class-name":e.labelClassName},E({_:2},[e.defaultSlot?{name:"default",fn:C(({node:n})=>[$(e.$slots,"default",{node:n},()=>[v("div",Me,[v("span",null,b(n[e.keys.label]),1)])])])}:void 0,e.expandSlot?{name:"expand",fn:C(({node:n})=>[$(e.$slots,"expand",{node:n},()=>[ke])])}:void 0]),1032,["modelValue","props","data","horizontal","label-style","collapsable","render-content","label-class-name"])):h("v-if",!0),e.nodeMenus.length?(y(),z(c,{key:2,modelValue:e.contextmenu,"onUpdate:modelValue":n[2]||(n[2]=n=>e.contextmenu=n),x:e.menuX,y:e.menuY,node:e.menuData,data:e.data,props:e.keys,menus:e.nodeMenus,disabled:e.disabled,"node-add":e.nodeAdd,"node-delete":e.nodeDelete,"node-edit":e.nodeEdit,"node-copy":e.nodeCopy,onContextmenu:n[3]||(n[3]=n=>{e.$emit("on-contextmenu",n)}),onOnNodeCopy:n[4]||(n[4]=n=>{e.$emit("on-node-copy",n)}),onOnNodeDelete:n[5]||(n[5]=n=>{e.$emit("on-node-delete",n)})},null,8,["modelValue","x","y","node","data","props","menus","disabled","node-add","node-delete","node-edit","node-copy"])):h("v-if",!0)],512)},ze.__file="src/components/tree-org/src/tree.vue",ze.install=function(e){e.component(ze.name,ze)};const Oe={class:"xn-ht500"},_e=e({name:"organizationChart"}),we=F(Object.assign(_e,{setup(e){const t=n({});return A.userLoginOrgTree().then(e=>{t.value=e[0]}),(e,n)=>(y(),g("div",Oe,[D(R(ze),{class:"xn-tree-line",data:R(t),"tool-bar":{scale:!0,restore:!1,expand:!1,zoom:!0,fullscreen:!0},disabled:!1,center:!0,scalable:!0,"draggable-on-node":!1,"node-draggable":!1,"clone-node-drag":!1,"define-menus":[],"default-expand-level":3},null,8,["data"])]))}}),[["__scopeId","data-v-599e09b0"]]);export{we as default};
