import{r as e}from"./formRules-B2bzcXv4.js";import{p as a}from"./pushApi-CT8GWz8o.js";import{a as l}from"./mdEditor-CRikn6Cm.js";import{f as t}from"./fileApi-DnApfrPK.js";import{b as u,k as o}from"./ant-design-vendor-CRFwT3Wn.js";import{d as n,f as s,a1 as p,a6 as d,V as r,a2 as i,k as c,Z as h,U as m,u as v,G as f,H as y}from"./vue-vendor-BzDj5Url.js";import"./index-DcffTgQN.js";import"./office-vendor-CP0gN6-y.js";const T={key:6},U=n({name:"WorkWechatPushSend"}),E=Object.assign(U,{emits:{loadingStart:null,loadingEnd:null},setup(n,{expose:U,emit:E}){const k=E,N=s(),g=s({noticeType:"NONE",pushType:"TEXT"}),W=s(""),_={pushType:[e("请选择推送方式")],title:[e("请输入消息标题")],picUrl:[e("请输入图片URL")],messageUrl:[e("请输入跳转地址")],phones:[e("请输入手机号，多个逗号拼接")],noticeType:[e("请选择推送类型")],content:[e("请输入推送内容")]},b=(e,a,l)=>{const u=new FormData;u.append("file",l[0]),t.fileUploadLocalReturnUrl(u).then(e=>{a({url:e,desc:l[0].name})})};return U({send:()=>{N.value.validate().then(()=>{k("loadingStart");const e=u(g.value);"TEXT"===e.pushType?a.pushWorkWechatText(g.value).then(()=>{o.success("推送成功")}).catch(()=>{}).finally(()=>{k("loadingEnd")}):"MARKDOWN"===e.pushType?(g.value.content=W.value,a.pushWorkWechatMarkdown(g.value).then(()=>{o.success("推送成功")}).catch(()=>{}).finally(()=>{k("loadingEnd")})):"NEWS"===e.pushType?a.pushWorkWechatNews(g.value).then(()=>{o.success("推送成功")}).catch(()=>{}).finally(()=>{k("loadingEnd")}):o.warning("不支持的推送类型")}).catch(()=>{})}}),(e,a)=>{const t=p("a-radio-button"),u=p("a-radio-group"),o=p("a-form-item"),n=p("a-radio"),s=p("a-input"),U=p("a-textarea"),E=p("a-form");return r(),d(E,{ref_key:"formRef",ref:N,model:v(g),rules:_,layout:"vertical"},{default:i(()=>[c(o,{label:"推送方式：",name:"pushType"},{default:i(()=>[c(u,{value:v(g).pushType,"onUpdate:value":a[0]||(a[0]=e=>v(g).pushType=e),"button-style":"solid",onChange:a[1]||(a[1]=e=>{v(g).pushType&&(g.value.noticeType="NONE")})},{default:i(()=>[c(t,{value:"TEXT"},{default:i(()=>a[9]||(a[9]=[f("文本消息")])),_:1}),c(t,{value:"MARKDOWN"},{default:i(()=>a[10]||(a[10]=[f("Markdown")])),_:1}),c(t,{value:"NEWS"},{default:i(()=>a[11]||(a[11]=[f("企业微信NEWS")])),_:1})]),_:1},8,["value"])]),_:1}),"TEXT"===v(g).pushType?(r(),d(o,{key:0,label:"通知类型：",name:"noticeType"},{default:i(()=>[c(u,{value:v(g).noticeType,"onUpdate:value":a[2]||(a[2]=e=>v(g).noticeType=e)},{default:i(()=>[c(n,{value:"NONE"},{default:i(()=>a[12]||(a[12]=[f("无")])),_:1}),"TEXT"===v(g).pushType?(r(),d(n,{key:0,value:"PHONE"},{default:i(()=>a[13]||(a[13]=[f("指定手机号")])),_:1})):h("",!0),c(n,{value:"ALL"},{default:i(()=>a[14]||(a[14]=[f("通知所有人")])),_:1})]),_:1},8,["value"])]),_:1})):h("",!0),"MARKDOWN"===v(g).pushType||"NEWS"===v(g).pushType?(r(),d(o,{key:1,label:"消息标题：",name:"title"},{default:i(()=>[c(s,{value:v(g).title,"onUpdate:value":a[3]||(a[3]=e=>v(g).title=e),placeholder:"请输入消息标题","allow-clear":""},null,8,["value"])]),_:1})):h("",!0),"MARKDOWN"!==v(g).pushType?(r(),d(o,{key:2,label:"消息内容：",name:"content"},{default:i(()=>[c(U,{value:v(g).content,"onUpdate:value":a[4]||(a[4]=e=>v(g).content=e),placeholder:"请输入推送内容","auto-size":{minRows:5,maxRows:10}},null,8,["value"])]),_:1})):h("",!0),"MARKDOWN"===v(g).pushType?(r(),d(o,{key:3,label:"Markdown内容："},{default:i(()=>[c(v(l),{modelValue:v(W),"onUpdate:modelValue":a[5]||(a[5]=e=>y(W)?W.value=e:null),onUploadImage:b,"disabled-menus":[],height:"500px","left-toolbar":"undo redo clear | h bold italic strikethrough quote | ul ol table hr | link image"},null,8,["modelValue"])]),_:1})):h("",!0),"NEWS"===v(g).pushType?(r(),d(o,{key:4,label:"图片URL：",name:"picUrl"},{default:i(()=>[c(s,{value:v(g).picUrl,"onUpdate:value":a[6]||(a[6]=e=>v(g).picUrl=e),placeholder:"请输入图片URL","allow-clear":""},null,8,["value"])]),_:1})):h("",!0),"NEWS"===v(g).pushType?(r(),d(o,{key:5,label:"跳转地址：",name:"messageUrl"},{default:i(()=>[c(s,{value:v(g).messageUrl,"onUpdate:value":a[7]||(a[7]=e=>v(g).messageUrl=e),placeholder:"请输入跳转地址","allow-clear":""},null,8,["value"])]),_:1})):h("",!0),"TEXT"===v(g).pushType?(r(),m("div",T,["PHONE"===v(g).noticeType?(r(),d(o,{key:0,label:"手机号：",name:"phones"},{default:i(()=>[c(U,{value:v(g).phones,"onUpdate:value":a[8]||(a[8]=e=>v(g).phones=e),placeholder:"请输入手机号，多个逗号拼接","auto-size":{minRows:2,maxRows:5}},null,8,["value"])]),_:1})):h("",!0)])):h("",!0)]),_:1},8,["model"])}}});export{E as default};
