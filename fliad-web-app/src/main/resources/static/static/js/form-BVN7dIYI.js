import{_ as e}from"./index-yhO5Pkur.js";import{r as a}from"./formRules-B2bzcXv4.js";import{t as l}from"./index-DcffTgQN.js";import{r as o}from"./roleApi-AgyZA8--.js";import{d as t,f as r,a1 as s,a6 as n,V as u,a2 as d,k as c,u as i,Z as m,G as v}from"./vue-vendor-BzDj5Url.js";import"./ant-design-vendor-CRFwT3Wn.js";const f=t({name:"roleForm"}),p=Object.assign(f,{emits:{successful:null},setup(t,{expose:f,emit:p}){const g=p,y=r(!1),b=r(),h=r({}),x=r([]),_=r(!1),w=()=>{y.value=!1},C={orgId:[a("请选择所属组织")],name:[a("请输入角色名称")],code:[a("请输入角色编码")],category:[a("请选择角色分类")],sortCode:[a("请选择排序")]};let j=l.dictList("ROLE_CATEGORY");const O=()=>{b.value.validate().then(()=>{_.value=!0,o.submitForm(h.value,h.value.id).then(()=>{y.value=!1,g("successful")}).finally(()=>{_.value=!1})}).catch(()=>{})};return f({onOpen:(e,a,t)=>{y.value=!0,a&&(h.value.category=a),t&&(h.value.category="ORG",h.value.orgId=t),e?h.value=Object.assign({},e):(h.value.sortCode=99,h.value.code=l.generateString(10)),o.roleOrgTreeSelector().then(e=>{x.value=e})}}),(a,l)=>{const o=s("a-input"),t=s("a-form-item"),r=s("a-select"),f=s("a-tree-select"),p=s("a-input-number"),g=s("a-form"),R=s("a-button"),k=e;return u(),n(k,{title:i(h).id?"编辑角色":"增加角色",width:550,visible:i(y),"destroy-on-close":!0,onClose:w},{footer:d(()=>[c(R,{class:"xn-mr8",onClick:w},{default:d(()=>l[5]||(l[5]=[v("关闭")])),_:1}),c(R,{type:"primary",loading:i(_),onClick:O},{default:d(()=>l[6]||(l[6]=[v("保存")])),_:1},8,["loading"])]),default:d(()=>[c(g,{ref_key:"formRef",ref:b,model:i(h),rules:C,layout:"vertical"},{default:d(()=>[c(t,{label:"角色名称：",name:"name"},{default:d(()=>[c(o,{value:i(h).name,"onUpdate:value":l[0]||(l[0]=e=>i(h).name=e),placeholder:"请输入角色名称","allow-clear":""},null,8,["value"])]),_:1}),c(t,{label:"角色编码：",name:"code"},{default:d(()=>[c(o,{value:i(h).code,"onUpdate:value":l[1]||(l[1]=e=>i(h).code=e),placeholder:"请输入角色编码","allow-clear":""},null,8,["value"])]),_:1}),c(t,{label:"角色分类：",name:"category"},{default:d(()=>[c(r,{value:i(h).category,"onUpdate:value":l[2]||(l[2]=e=>i(h).category=e),options:i(j),class:"xn-wd",placeholder:"请选择角色分类"},null,8,["value","options"])]),_:1}),"ORG"===i(h).category?(u(),n(t,{key:0,label:"所属机构：",name:"orgId"},{default:d(()=>[c(f,{value:i(h).orgId,"onUpdate:value":l[3]||(l[3]=e=>i(h).orgId=e),class:"xn-wd","dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择组织","allow-clear":"","tree-default-expand-all":"","tree-data":i(x),"field-names":{children:"children",label:"name",value:"id"},selectable:"false","tree-line":""},null,8,["value","tree-data"])]),_:1})):m("",!0),c(t,{label:"排序：",name:"sortCode"},{default:d(()=>[c(p,{class:"xn-wd",value:i(h).sortCode,"onUpdate:value":l[4]||(l[4]=e=>i(h).sortCode=e),max:100},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","visible"])}}});export{p as default};
