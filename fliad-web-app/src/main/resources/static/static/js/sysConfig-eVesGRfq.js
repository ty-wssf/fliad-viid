import{r as _}from"./formRules-B2bzcXv4.js";import{g as e,t as a}from"./index-DcffTgQN.js";import{c as l}from"./configApi-BMiyCPj3.js";import{_ as S}from"./menuTreeSelect-BjnhLlQh.js";import{k as t,b as u}from"./ant-design-vendor-CRFwT3Wn.js";import{d as O,f as N,a1 as Y,a6 as n,V as E,a2 as d,k as s,u as A,U as o,Y as f,G as r}from"./vue-vendor-BzDj5Url.js";const c=["src"],i={key:1},L=O({name:"sysConfig"}),p=Object.assign(L,{emits:{successful:null},setup(O,{emit:L}){const p=N(),T=N({}),U=N(!1),F=N(""),W=N(),D=N(!0),I=e();l.configList({category:"SYS_BASE"}).then(_=>{D.value=!1,_?_.forEach(_=>{if("SNOWY_SYS_LOGO"===_.configKey)T.value[_.configKey]=[_.configValue],F.value=_.configValue;else if("SNOWY_SYS_DEFAULT_WORKBENCH_DATA"===_.configKey)try{W.value.setSelectData(JSON.parse(_.configValue).shortcut)}catch(e){}else T.value[_.configKey]=m(_.configValue)}):t.warning("表单项不存在，请初始化数据库")});const R=a.dictList("FILE_ENGINE"),C=a.dictList("SMS_ENGINE"),v=a.dictList("EMAIL_ENGINE"),G=a.dictList("PUSH_ENGINE"),m=_=>"true"===_||"false"===_?"true"===_:_,P=_=>{T.value.SNOWY_SYS_LOGO=N([]),g(_.file).then(_=>{F.value=_,T.value.SNOWY_SYS_LOGO.push(_)}).catch(_=>{})},g=_=>new Promise((e,a)=>{const l=new FileReader;l.readAsDataURL(_),l.onload=()=>e(l.result),l.onerror=_=>a(_)}),h={SNOWY_SYS_LOGO:[_("请上传系统LOGO")],SNOWY_SYS_NAME:[_("请输入系统名称")],SNOWY_SYS_VERSION:[_("请输入系统版本")],SNOWY_SYS_COPYRIGHT:[_("请输入版权信息")],SNOWY_SYS_COPYRIGHT_URL:[_("请输入版权链接URL")],SNOWY_SYS_DEFAULT_FILE_ENGINE:[_("请选择系统默认文件引擎")],SNOWY_SYS_DEFAULT_SMS_ENGINE:[_("请选择系统默认短信引擎")],SNOWY_SYS_DEFAULT_EMAIL_ENGINE:[_("请选择系统默认邮件引擎")],SNOWY_SYS_DEFAULT_PUSH_ENGINE:[_("请选择系统默认消息推送引擎")],SNOWY_SYS_DEFAULT_CAPTCHA_OPEN_FLAG_FOR_C:[_("请选择前台验证码开关")],SNOWY_SYS_DEFAULT_CAPTCHA_OPEN_FLAG_FOR_B:[_("请选择后台验证码开关")],SNOWY_SYS_DEFAULT_CAPTCHA_EXPIRED_DURATION_FOR_C:[_("请输入过期时间")],SNOWY_SYS_DEFAULT_CAPTCHA_EXPIRED_DURATION_FOR_B:[_("请输入过期时间")],SNOWY_SYS_DEFAULT_PASSWORD:[_("请输入系统重置密码默认密码")]};N({style:{width:"200px"}});const H=()=>{F.value="",T.value={SNOWY_SYS_DEFAULT_CAPTCHA_OPEN_FLAG_FOR_C:!0,SNOWY_SYS_DEFAULT_CAPTCHA_OPEN_FLAG_FOR_B:!0,SNOWY_SYS_DEFAULT_FILE_ENGINE:"LOCAL",SNOWY_SYS_DEFAULT_SMS_ENGINE:"XIAONUO",SNOWY_SYS_DEFAULT_EMAIL_ENGINE:"LOCAL",SNOWY_SYS_DEFAULT_PUSH_ENGINE:"DINGTALK"}},b={span:16},y={span:22};return(_,e)=>{const t=Y("plus-outlined"),O=Y("a-upload"),N=Y("a-form-item"),L=Y("a-col"),m=Y("a-row"),g=Y("a-input"),k=Y("a-switch"),M=Y("a-input-number"),B=Y("a-radio-group"),w=Y("a-textarea"),x=Y("a-button"),j=Y("a-form"),V=Y("a-spin");return E(),n(V,{spinning:A(D)},{default:d(()=>[s(j,{ref_key:"formRef",ref:p,model:A(T),rules:h,layout:"vertical","label-col":{...b,offset:0},"wrapper-col":{...y,offset:0},style:{width:"90%"}},{default:d(()=>[s(m,{gutter:16},{default:d(()=>[s(L,{span:4},{default:d(()=>[s(N,{label:"系统LOGO：",name:"SNOWY_SYS_LOGO"},{default:d(()=>[s(O,{"file-list":A(T).SNOWY_SYS_LOGO,"onUpdate:fileList":e[0]||(e[0]=_=>A(T).SNOWY_SYS_LOGO=_),class:"avatar-uploader","list-type":"picture-card","show-upload-list":!1,"custom-request":P,accept:"image/png, image/jpeg, image/jpg"},{default:d(()=>[A(F)?(E(),o("img",{key:0,src:A(F),alt:"avatar",style:{"max-height":"100px","max-width":"100px"}},null,8,c)):(E(),o("div",i,[s(t),e[15]||(e[15]=f("div",{class:"ant-upload-text"},"上传",-1))]))]),_:1},8,["file-list"])]),_:1})]),_:1})]),_:1}),s(m,{gutter:8},{default:d(()=>[s(L,{span:8},{default:d(()=>[s(N,{label:"系统名称：",name:"SNOWY_SYS_NAME"},{default:d(()=>[s(g,{value:A(T).SNOWY_SYS_NAME,"onUpdate:value":e[1]||(e[1]=_=>A(T).SNOWY_SYS_NAME=_),placeholder:"请输入系统名称"},null,8,["value"])]),_:1})]),_:1}),s(L,{span:14},{default:d(()=>[s(m,{gutter:8},{default:d(()=>[s(L,{span:12},{default:d(()=>[s(N,{label:"后台验证码开关：",name:"SNOWY_SYS_DEFAULT_CAPTCHA_OPEN_FLAG_FOR_B"},{default:d(()=>[s(k,{checked:A(T).SNOWY_SYS_DEFAULT_CAPTCHA_OPEN_FLAG_FOR_B,"onUpdate:checked":e[2]||(e[2]=_=>A(T).SNOWY_SYS_DEFAULT_CAPTCHA_OPEN_FLAG_FOR_B=_),"checked-children":"开","un-checked-children":"关",placeholder:"请选择后台验证码开关"},null,8,["checked"])]),_:1})]),_:1}),s(L,{span:12},{default:d(()=>[s(N,{label:"前台验证码开关：",name:"SNOWY_SYS_DEFAULT_CAPTCHA_OPEN_FLAG_FOR_C"},{default:d(()=>[s(k,{checked:A(T).SNOWY_SYS_DEFAULT_CAPTCHA_OPEN_FLAG_FOR_C,"onUpdate:checked":e[3]||(e[3]=_=>A(T).SNOWY_SYS_DEFAULT_CAPTCHA_OPEN_FLAG_FOR_C=_),"checked-children":"开","un-checked-children":"关",placeholder:"请选择前台验证码开关"},null,8,["checked"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(m,{gutter:8},{default:d(()=>[s(L,{span:8},{default:d(()=>[s(N,{label:"系统版本：",name:"SNOWY_SYS_VERSION"},{default:d(()=>[s(g,{value:A(T).SNOWY_SYS_VERSION,"onUpdate:value":e[4]||(e[4]=_=>A(T).SNOWY_SYS_VERSION=_),placeholder:"请输入系统版本"},null,8,["value"])]),_:1})]),_:1}),s(L,{span:14},{default:d(()=>[s(m,{gutter:8},{default:d(()=>[s(L,{span:12},{default:d(()=>[s(N,{label:"全局后台验证码失效时间：",name:"SNOWY_SYS_DEFAULT_CAPTCHA_EXPIRED_DURATION_FOR_B"},{default:d(()=>[s(M,{value:A(T).SNOWY_SYS_DEFAULT_CAPTCHA_EXPIRED_DURATION_FOR_B,"onUpdate:value":e[5]||(e[5]=_=>A(T).SNOWY_SYS_DEFAULT_CAPTCHA_EXPIRED_DURATION_FOR_B=_),placeholder:"分钟"},{addonAfter:d(()=>e[16]||(e[16]=[r(" 分钟 ")])),_:1},8,["value"])]),_:1})]),_:1}),s(L,{span:12},{default:d(()=>[s(N,{label:"全局前台验证码失效时间：",name:"SNOWY_SYS_DEFAULT_CAPTCHA_EXPIRED_DURATION_FOR_C"},{default:d(()=>[s(M,{value:A(T).SNOWY_SYS_DEFAULT_CAPTCHA_EXPIRED_DURATION_FOR_C,"onUpdate:value":e[6]||(e[6]=_=>A(T).SNOWY_SYS_DEFAULT_CAPTCHA_EXPIRED_DURATION_FOR_C=_),placeholder:"分钟"},{addonAfter:d(()=>e[17]||(e[17]=[r(" 分钟 ")])),_:1},8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(m,{gutter:8},{default:d(()=>[s(L,{span:8},{default:d(()=>[s(N,{label:"版权信息：",name:"SNOWY_SYS_COPYRIGHT"},{default:d(()=>[s(g,{value:A(T).SNOWY_SYS_COPYRIGHT,"onUpdate:value":e[7]||(e[7]=_=>A(T).SNOWY_SYS_COPYRIGHT=_),placeholder:"请输入版权信息"},null,8,["value"])]),_:1})]),_:1}),s(L,{span:14},{default:d(()=>[s(m,{gutter:8},{default:d(()=>[s(L,{span:12},{default:d(()=>[s(N,{label:"默认文件引擎：",name:"SNOWY_SYS_DEFAULT_FILE_ENGINE"},{default:d(()=>[s(B,{value:A(T).SNOWY_SYS_DEFAULT_FILE_ENGINE,"onUpdate:value":e[8]||(e[8]=_=>A(T).SNOWY_SYS_DEFAULT_FILE_ENGINE=_),options:A(R),placeholder:"请选择系统默认文件引擎"},null,8,["value","options"])]),_:1})]),_:1}),s(L,{span:12},{default:d(()=>[s(N,{label:"默认短信引擎：",name:"SNOWY_SYS_DEFAULT_SMS_ENGINE"},{default:d(()=>[s(B,{value:A(T).SNOWY_SYS_DEFAULT_SMS_ENGINE,"onUpdate:value":e[9]||(e[9]=_=>A(T).SNOWY_SYS_DEFAULT_SMS_ENGINE=_),options:A(C),placeholder:"请选择系统默认短信引擎"},null,8,["value","options"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(m,{gutter:8},{default:d(()=>[s(L,{span:8},{default:d(()=>[s(N,{label:"版权链接URL：",name:"SNOWY_SYS_COPYRIGHT_URL"},{default:d(()=>[s(g,{value:A(T).SNOWY_SYS_COPYRIGHT_URL,"onUpdate:value":e[10]||(e[10]=_=>A(T).SNOWY_SYS_COPYRIGHT_URL=_),placeholder:"请输入版权链接URL"},null,8,["value"])]),_:1})]),_:1}),s(L,{span:14},{default:d(()=>[s(m,{gutter:8},{default:d(()=>[s(L,{span:12},{default:d(()=>[s(N,{label:"默认邮件引擎：",name:"SNOWY_SYS_DEFAULT_EMAIL_ENGINE"},{default:d(()=>[s(B,{value:A(T).SNOWY_SYS_DEFAULT_EMAIL_ENGINE,"onUpdate:value":e[11]||(e[11]=_=>A(T).SNOWY_SYS_DEFAULT_EMAIL_ENGINE=_),options:A(v),placeholder:"请选择系统默认邮件引擎"},null,8,["value","options"])]),_:1})]),_:1}),s(L,{span:12},{default:d(()=>[s(N,{label:"默认消息推送引擎：",name:"SNOWY_SYS_DEFAULT_PUSH_ENGINE"},{default:d(()=>[s(B,{value:A(T).SNOWY_SYS_DEFAULT_PUSH_ENGINE,"onUpdate:value":e[12]||(e[12]=_=>A(T).SNOWY_SYS_DEFAULT_PUSH_ENGINE=_),options:A(G),placeholder:"请选择系统默认消息推送引擎"},null,8,["value","options"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(m,{gutter:16},{default:d(()=>[s(L,{span:8},{default:d(()=>[s(N,{label:"默认快捷方式：",name:"SNOWY_SYS_DEFAULT_WORKBENCH_DATA"},{default:d(()=>[s(S,{ref_key:"menuTreeSelectRef",ref:W,resultData:!0},null,512)]),_:1})]),_:1}),s(L,{span:14},{default:d(()=>[s(N,{label:"系统描述：",name:"SNOWY_SYS_DEFAULT_DESCRRIPTION"},{default:d(()=>[s(w,{value:A(T).SNOWY_SYS_DEFAULT_DESCRRIPTION,"onUpdate:value":e[13]||(e[13]=_=>A(T).SNOWY_SYS_DEFAULT_DESCRRIPTION=_),placeholder:"请输入系统描述","auto-size":{minRows:3,maxRows:6}},null,8,["value"])]),_:1})]),_:1})]),_:1}),s(m,{gutter:14},{default:d(()=>[s(L,{span:12},{default:d(()=>[s(N,null,{default:d(()=>[s(x,{type:"primary",loading:A(U),onClick:e[14]||(e[14]=_=>{p.value.validate().then(()=>{U.value=!0;let _=u(T.value);const e={shortcut:W.value.getSelectData()};_.SNOWY_SYS_DEFAULT_WORKBENCH_DATA=JSON.stringify(e),_.SNOWY_SYS_LOGO=_.SNOWY_SYS_LOGO[0];const S=Object.entries(_).map(_=>({configKey:_[0],configValue:_[1]}));l.configEditForm(S).then(()=>{a.data.set("SNOWY_SYS_BASE_CONFIG",_),I.setSysBaseConfig(_)}).finally(()=>{U.value=!1})}).catch(()=>{})})},{default:d(()=>e[18]||(e[18]=[r("保存")])),_:1},8,["loading"]),s(x,{class:"xn-ml10",onClick:H},{default:d(()=>e[19]||(e[19]=[r("重置")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","label-col","wrapper-col"])]),_:1},8,["spinning"])}}});export{p as default};
