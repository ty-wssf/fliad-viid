import{_ as e}from"./index-r8v7tfQO.js";import{b as a}from"./bizOrgApi-8pcz4RXq.js";import t from"./form-Du_R7sUL.js";import{_ as l,i as r}from"./index-DcffTgQN.js";import{x as n,w as d}from"./ant-design-vendor-CRFwT3Wn.js";import{d as o,f as s,a1 as i,U as u,V as c,k as f,a2 as m,u as p,a6 as h,H as g,G as y,Z as v,F as _,a3 as b}from"./vue-vendor-BzDj5Url.js";import"./index-yhO5Pkur.js";import"./index-CkDqqgfU.js";import"./formRules-B2bzcXv4.js";const k=["onClick"],x=o({name:"bizOrg"}),O=l(Object.assign(x,{setup(l){const o=[{title:"机构名称",dataIndex:"name"},{title:"分类",dataIndex:"category"},{title:"排序",dataIndex:"sortCode",width:100}];r(["bizOrgEdit","bizOrgDelete"])&&o.push({title:"操作",dataIndex:"action",align:"center",width:"150px"});const x=s([]),O={alert:{show:!1,clear:()=>{x.value=s([])}},rowSelection:{onChange:(e,a)=>{x.value=e}}},w={refresh:!0,height:!0,columnSetting:!0},I=s(null),C=s(),j=s(),z=s({}),E=s([]),D=s([]),R={children:"children",title:"name",key:"id"},S=s(!0),K=e=>(T(),a.orgPage(Object.assign(e,z.value)).then(e=>e)),P=()=>{j.value.resetFields(),I.value.refresh(!0)},T=()=>{a.orgTree().then(e=>{S.value=!1,null!==e&&(D.value=e,d(E.value)&&D.value.forEach(e=>{"0"===e.parentId&&(E.value.push(e.id),e.children&&e.children.forEach(e=>{E.value.push(e.id)}))}))}).finally(()=>{S.value=!1})},A=e=>{e.length>0?z.value.parentId=e.toString():delete z.value.parentId,I.value.refresh(!0)},G=e=>{a.orgDelete(e).then(()=>{I.value.clearRefreshSelected()})};return(l,r)=>{const d=i("a-tree"),s=i("a-empty"),T=i("a-card"),B=i("a-col"),F=i("a-input"),U=i("a-form-item"),L=i("SearchOutlined"),M=i("a-button"),N=i("redo-outlined"),H=i("a-row"),V=i("a-form"),W=i("plus-outlined"),Y=e,Z=i("a-space"),$=i("a-divider"),q=i("a-popconfirm"),J=i("s-table");return c(),u(_,null,[f(H,{gutter:10},{default:m(()=>[f(B,{xs:24,sm:24,md:24,lg:5,xl:5},{default:m(()=>[f(T,{bordered:!1,loading:p(S),class:"left-tree-container"},{default:m(()=>[p(D).length>0?(c(),h(d,{key:0,expandedKeys:p(E),"onUpdate:expandedKeys":r[0]||(r[0]=e=>g(E)?E.value=e:null),"tree-data":p(D),"field-names":R,onSelect:A},null,8,["expandedKeys","tree-data"])):(c(),h(s,{key:1,image:p(n).PRESENTED_IMAGE_SIMPLE},null,8,["image"]))]),_:1},8,["loading"])]),_:1}),f(B,{xs:24,sm:24,md:24,lg:19,xl:19},{default:m(()=>[f(T,{bordered:!1,class:"xn-mb10"},{default:m(()=>[f(V,{ref_key:"searchFormRef",ref:j,name:"advanced_search",class:"ant-advanced-search-form",model:p(z)},{default:m(()=>[f(H,{gutter:24},{default:m(()=>[f(B,{span:8},{default:m(()=>[f(U,{name:"searchKey",label:"名称关键词"},{default:m(()=>[f(F,{value:p(z).searchKey,"onUpdate:value":r[1]||(r[1]=e=>p(z).searchKey=e),placeholder:"请输入机构名称关键词"},null,8,["value"])]),_:1})]),_:1}),f(B,{span:8},{default:m(()=>[f(M,{type:"primary",onClick:r[2]||(r[2]=e=>p(I).refresh(!0))},{icon:m(()=>[f(L)]),default:m(()=>[r[5]||(r[5]=y(" 查询 "))]),_:1}),f(M,{class:"snowy-button-left",onClick:P},{icon:m(()=>[f(N)]),default:m(()=>[r[6]||(r[6]=y(" 重置 "))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),f(T,{bordered:!1},{default:m(()=>[f(J,{ref_key:"tableRef",ref:I,columns:o,data:K,"expand-row-by-click":!0,alert:O.alert.show,bordered:"","row-key":e=>e.id,"tool-config":w,"row-selection":O.rowSelection},{operator:m(()=>[f(Z,null,{default:m(()=>[l.hasPerm("bizOrgAdd")?(c(),h(M,{key:0,type:"primary",onClick:r[3]||(r[3]=e=>p(C).onOpen(void 0,p(z).parentId))},{icon:m(()=>[f(W)]),default:m(()=>[r[7]||(r[7]=y(" 新增 "))]),_:1})):v("",!0),l.hasPerm("bizOrgBatchDelete")?(c(),h(Y,{key:1,buttonName:"批量删除",icon:"DeleteOutlined",buttonDanger:"",selectedRowKeys:p(x),onBatchCallBack:G},null,8,["selectedRowKeys"])):v("",!0)]),_:1})]),bodyCell:m(({column:e,record:t})=>["category"===e.dataIndex?(c(),u(_,{key:0},[y(b(l.$TOOL.dictTypeData("ORG_CATEGORY",t.category)),1)],64)):v("",!0),"action"===e.dataIndex?(c(),u(_,{key:1},[l.hasPerm("bizOrgEdit")?(c(),u("a",{key:0,onClick:e=>p(C).onOpen(t)},"编辑",8,k)):v("",!0),l.hasPerm(["bizOrgEdit","bizOrgDelete"],"and")?(c(),h($,{key:1,type:"vertical"})):v("",!0),f(q,{title:"删除此机构与下级机构吗？",onConfirm:e=>(e=>{let t=[{id:e.id}];a.orgDelete(t).then(()=>{I.value.refresh(!0)})})(t)},{default:m(()=>[l.hasPerm("bizOrgDelete")?(c(),h(M,{key:0,type:"link",danger:"",size:"small"},{default:m(()=>r[8]||(r[8]=[y("删除")])),_:1})):v("",!0)]),_:2},1032,["onConfirm"])],64)):v("",!0)]),_:1},8,["alert","row-key","row-selection"])]),_:1})]),_:1})]),_:1}),f(t,{ref_key:"formRef",ref:C,onSuccessful:r[4]||(r[4]=e=>p(I).refresh())},null,512)],64)}}}),[["__scopeId","data-v-20706ee6"]]);export{O as default};
