import{_ as e}from"./index-yhO5Pkur.js";import{r as a,a as l}from"./formRules-B2bzcXv4.js";import{S as t}from"./snowflake-id-Ddy3gscf.js";import{_ as n,t as o}from"./index-DcffTgQN.js";import{m as u}from"./menuApi-DZDEix35.js";import{I as s}from"./iconSelector-BS7wf_Ak.js";import{b as i}from"./ant-design-vendor-CRFwT3Wn.js";import{d,f as p,a1 as r,a6 as m,V as c,a2 as v,k as f,u as y,Z as _,H as b,G as h,a3 as T}from"./vue-vendor-BzDj5Url.js";const L=d({name:"sysResourceMenuForm"}),k=n(Object.assign(L,{emits:{successful:null},setup(n,{expose:d,emit:L}){const k=p(!1),E=L,U=p(),w=p([]),C=p(),x=p({}),g=p([0]),M=p(!1),I=p(""),O=()=>{U.value.resetFields(),k.value=!1},j=e=>{e&&U.value.clearValidate("icon"),x.value.icon=e},N={title:[a("请输入菜单名称"),l.horizontalChart],parentId:[a("请选择上级菜单")],menuType:[a("请选择菜单类型")],path:[a("请输入路由地址")],name:[a("请输入组件中name属性")],module:[a("请选择模块")],component:[a("请输入组件地址"),l.initialNotBackslashChart],visible:[a("请选择是否可见")],keepLive:[a("请选择标签页下是否缓存")],displayLayout:[a("请选择布局是否可见")]},A=o.dictList("MENU_TYPE"),S=o.dictList("MENU_VISIBLE"),R=o.dictList("COMMON_WHETHER"),H=o.dictList("COMMON_WHETHER"),G=()=>{U.value.validate().then(()=>{const e=Y(x.value);M.value=!0,u.submitForm(e,e.id).then(()=>{O(),E("successful")}).finally(()=>{M.value=!1})}).catch(()=>{})},Y=e=>{if(e.module=I.value,"MENU"!==e.menuType){const a=(new t).generate();e.path||(e.path="/"+a),e.name||(e.name=a)}return e.component?("/"===e.component.slice(0,1)&&(e.component=e.component.slice(1)),e):e};return d({onOpen:(e,a)=>{const l=i(e);I.value=a,k.value=!0,l?(x.value=l,l.visible||(x.value.visible="TRUE"),l.keepLive||(x.value.keepLive="YES"),l.displayLayout||(x.value.displayLayout="YES")):(x.value={menuType:"MENU",visible:"TRUE",keepLive:"YES",displayLayout:"YES",sortCode:99},x.value=Object.assign(x.value,l));const t={module:a};u.menuTreeSelector(t).then(e=>{w.value=[{id:0,parentId:"-1",title:"顶级",children:e}]})}}),(a,l)=>{const t=r("a-alert"),n=r("a-input"),o=r("a-form-item"),i=r("a-col"),d=r("a-radio-group"),p=r("a-tree-select"),L=r("question-circle-outlined"),E=r("a-tooltip"),I=r("a-button"),Y=r("a-input-number"),B=r("a-row"),F=r("a-collapse-panel"),K=r("a-collapse"),V=r("a-form"),W=e;return c(),m(W,{title:y(x).id?"编辑菜单":"增加菜单",width:700,visible:y(k),"destroy-on-close":!0,onClose:O},{footer:v(()=>[f(I,{class:"xn-mr8",onClick:O},{default:v(()=>l[20]||(l[20]=[h("关闭")])),_:1}),f(I,{type:"primary",loading:y(M),onClick:G},{default:v(()=>l[21]||(l[21]=[h("保存")])),_:1},8,["loading"])]),default:v(()=>[f(t,{class:"mb-3",message:"温馨提示：排序第一为首页！若有多个模块根据授权可见情况而变化。",type:"warning"}),f(V,{ref_key:"formRef",ref:U,model:y(x),rules:N,layout:"vertical"},{default:v(()=>[f(B,{gutter:16},{default:v(()=>[f(i,{span:12},{default:v(()=>[f(o,{label:"显示名称：",name:"title"},{default:v(()=>[f(n,{value:y(x).title,"onUpdate:value":l[0]||(l[0]=e=>y(x).title=e),placeholder:"请输入显示名称","allow-clear":""},null,8,["value"])]),_:1})]),_:1}),f(i,{span:12},{default:v(()=>[f(o,{label:"菜单类型：",name:"menuType"},{default:v(()=>[f(d,{value:y(x).menuType,"onUpdate:value":l[1]||(l[1]=e=>y(x).menuType=e),"button-style":"solid",options:y(A),"option-type":"button"},null,8,["value","options"])]),_:1})]),_:1}),f(i,{span:12},{default:v(()=>[f(o,{label:"上级菜单：",name:"parentId"},{default:v(()=>[f(p,{value:y(x).parentId,"onUpdate:value":l[2]||(l[2]=e=>y(x).parentId=e),treeExpandedKeys:y(g),"onUpdate:treeExpandedKeys":l[3]||(l[3]=e=>b(g)?g.value=e:null),class:"xn-wd","dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择上级菜单","allow-clear":"","tree-default-expand-all":"","tree-data":y(w),"field-names":{children:"children",label:"title",value:"id"},selectable:"false","tree-line":"",onChange:l[4]||(l[4]=e=>(e=>{if(e>0){const a={id:e};u.menuDetail(a).then(e=>{x.value.module=e.module})}else x.value.module=null})(y(x).parentId))},null,8,["value","treeExpandedKeys","tree-data"])]),_:1})]),_:1}),"CATALOG"!==y(x).menuType?(c(),m(i,{key:0,span:12},{default:v(()=>[f(o,{name:"path"},{label:v(()=>[f(E,null,{title:v(()=>l[14]||(l[14]=[h(" 类型为内外链时，输入https开头的链接即可（例：https://xiaonuo.vip）,正常路由前面必须有反斜杠！ ")])),default:v(()=>[f(L)]),_:1}),h("   "+T("MENU"===y(x).menuType||"CATALOG"===y(x).menuType?"路由地址":"https链接地址")+"： ",1)]),default:v(()=>[f(n,{value:y(x).path,"onUpdate:value":l[5]||(l[5]=e=>y(x).path=e),placeholder:"请输入路由地址","allow-clear":""},null,8,["value"])]),_:1})]),_:1})):_("",!0),"MENU"===y(x).menuType?(c(),m(i,{key:1,span:12},{default:v(()=>[f(o,{name:"component"},{label:v(()=>[f(E,null,{title:v(()=>l[15]||(l[15]=[h(" 按规范可设置为代码组件文件夹名称,注：首字母无反斜杠哦！ ")])),default:v(()=>[f(L)]),_:1}),l[16]||(l[16]=h("   组件地址： "))]),default:v(()=>[f(n,{value:y(x).component,"onUpdate:value":l[6]||(l[6]=e=>y(x).component=e),"addon-before":"src/views/",placeholder:"请输入组件地址","allow-clear":""},null,8,["value"])]),_:1})]),_:1})):_("",!0),"MENU"===y(x).menuType?(c(),m(i,{key:2,span:12},{default:v(()=>[f(o,{name:"name"},{label:v(()=>[f(E,null,{title:v(()=>l[17]||(l[17]=[h(" 按规范可设置为代码组件文件夹名称,注：首字母无反斜杠哦！ ")])),default:v(()=>[f(L)]),_:1}),l[18]||(l[18]=h("   别名： "))]),default:v(()=>[f(n,{value:y(x).name,"onUpdate:value":l[7]||(l[7]=e=>y(x).name=e),"addon-before":"setup name=",placeholder:"请输入组件组件中name属性","allow-clear":""},null,8,["value"])]),_:1})]),_:1})):_("",!0),f(i,{span:12},{default:v(()=>[f(o,{label:"图标：",name:"icon"},{default:v(()=>[f(n,{value:y(x).icon,"onUpdate:value":l[8]||(l[8]=e=>y(x).icon=e),class:"xn-wdcalc-70",placeholder:"请选择图标","allow-clear":"",disabled:""},null,8,["value"]),f(I,{type:"primary",onClick:l[9]||(l[9]=e=>y(C).showIconModal(y(x).icon))},{default:v(()=>l[19]||(l[19]=[h("选择")])),_:1})]),_:1})]),_:1}),f(i,{span:12},{default:v(()=>[f(o,{label:"排序:",name:"sortCode"},{default:v(()=>[f(Y,{class:"xn-wd",value:y(x).sortCode,"onUpdate:value":l[10]||(l[10]=e=>y(x).sortCode=e),max:100},null,8,["value"])]),_:1})]),_:1})]),_:1}),f(K,{ghost:""},{default:v(()=>[f(F,{key:"def",header:"展开更多"},{default:v(()=>[f(B,{gutter:16},{default:v(()=>[f(i,{span:8},{default:v(()=>[f(o,{label:"是否可见:",name:"visible"},{default:v(()=>[f(d,{optionType:"button",value:y(x).visible,"onUpdate:value":l[11]||(l[11]=e=>y(x).visible=e),options:y(S)},null,8,["value","options"])]),_:1})]),_:1}),"CATALOG"!==y(x).menuType?(c(),m(i,{key:0,span:8},{default:v(()=>[f(o,{label:"是否缓存:",name:"keepLive"},{default:v(()=>[f(d,{optionType:"button",value:y(x).keepLive,"onUpdate:value":l[12]||(l[12]=e=>y(x).keepLive=e),options:y(R)},null,8,["value","options"])]),_:1})]),_:1})):_("",!0),"CATALOG"!==y(x).menuType?(c(),m(i,{key:1,span:8},{default:v(()=>[f(o,{label:"布局可见:",name:"displayLayout"},{default:v(()=>[f(d,{optionType:"button",value:y(x).displayLayout,"onUpdate:value":l[13]||(l[13]=e=>y(x).displayLayout=e),options:y(H)},null,8,["value","options"])]),_:1})]),_:1})):_("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),f(s,{ref_key:"iconSelector",ref:C,onIconCallBack:j},null,512)]),_:1},8,["title","visible"])}}}),[["__scopeId","data-v-40dac652"]]);export{k as default};
