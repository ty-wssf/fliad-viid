import{_ as e}from"./index-yhO5Pkur.js";import{_ as a}from"./index-CkDqqgfU.js";import{r as s}from"./formRules-B2bzcXv4.js";import{m as t}from"./messageApi-BFWVtpEx.js";import{u as l}from"./userApi-BNWGxnHS.js";import{t as o}from"./index-DcffTgQN.js";import{k as r}from"./ant-design-vendor-CRFwT3Wn.js";import{d as u,f as i,a1 as n,a6 as c,V as m,a2 as d,k as p,u as v,G as f}from"./vue-vendor-BzDj5Url.js";const g=u({name:"messageForm"}),b=Object.assign(g,{emits:{successful:null},setup(u,{expose:g,emit:b}){const j=i(!1),_=b,y=i(!1),h=i(),x=i({}),A=()=>{_("successful"),y.value=!1},k={subject:[s("请输入主题")],category:[s("请选择站内信分类")]},w=o.dictList("MESSAGE_CATEGORY"),R=()=>{h.value.validate().then(()=>{j.value=!0,t.messageSend(x.value).then(()=>{r.success("发送成功"),A()}).finally(()=>{j.value=!1})}).catch(()=>{})},S={orgTreeApi:e=>l.userOrgTreeSelector(e).then(e=>Promise.resolve(e)),userPageApi:e=>l.userSelector(e).then(e=>Promise.resolve(e))};return g({onOpen:()=>{y.value=!0,x.value={}}}),(s,t)=>{const l=n("a-input"),o=n("a-form-item"),r=n("a-select"),u=n("a-textarea"),i=a,g=n("a-form"),b=n("a-button"),_=e;return m(),c(_,{title:"发送站内信",width:550,visible:v(y),"destroy-on-close":!0,onClose:A},{footer:d(()=>[p(b,{class:"xn-mr8",onClick:A},{default:d(()=>t[4]||(t[4]=[f("关闭")])),_:1}),p(b,{type:"primary",onClick:R,loading:v(j)},{default:d(()=>t[5]||(t[5]=[f("发送")])),_:1},8,["loading"])]),default:d(()=>[p(g,{ref_key:"formRef",ref:h,model:v(x),rules:k,layout:"vertical"},{default:d(()=>[p(o,{label:"主题：",name:"subject"},{default:d(()=>[p(l,{value:v(x).subject,"onUpdate:value":t[0]||(t[0]=e=>v(x).subject=e),placeholder:"请输入主题","allow-clear":""},null,8,["value"])]),_:1}),p(o,{label:"站内信分类：",name:"category"},{default:d(()=>[p(r,{value:v(x).category,"onUpdate:value":t[1]||(t[1]=e=>v(x).category=e),options:v(w),class:"xn-wd",placeholder:"请选择站内信分类"},null,8,["value","options"])]),_:1}),p(o,{label:"正文：",name:"content"},{default:d(()=>[p(u,{value:v(x).content,"onUpdate:value":t[2]||(t[2]=e=>v(x).content=e),placeholder:"请输入正文","auto-size":{minRows:5,maxRows:5}},null,8,["value"])]),_:1}),p(o,{label:"接收人：",name:"receiverIdList"},{default:d(()=>[p(i,{"org-tree-api":S.orgTreeApi,"user-page-api":S.userPageApi,"data-type":"object",value:v(x).receiverIdList,"onUpdate:value":t[3]||(t[3]=e=>v(x).receiverIdList=e)},null,8,["org-tree-api","user-page-api","value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])}}});export{b as default};
