import{_ as e}from"./index-yhO5Pkur.js";import{_ as a}from"./index-CkDqqgfU.js";import{r as l}from"./formRules-B2bzcXv4.js";import{b as r}from"./bizOrgApi-8pcz4RXq.js";import{t}from"./index-DcffTgQN.js";import{d as o,f as s,a1 as n,a6 as d,V as i,a2 as u,k as m,u as p,G as c}from"./vue-vendor-BzDj5Url.js";import"./ant-design-vendor-CRFwT3Wn.js";const v=o({name:"bizOrgForm"}),f=Object.assign(v,{emits:{successful:null},setup(o,{expose:v,emit:f}){const g=f,b=s(!1),h=s(),x=s({}),_=s([]),y=s(!1),j=()=>{b.value=!1},C={parentId:[l("请选择上级机构")],name:[l("请输入机构名称")],category:[l("请选择机构分类")],sortCode:[l("请选择排序")]},I=t.dictList("ORG_CATEGORY"),w=()=>{h.value.validate().then(()=>{y.value=!0,r.submitForm(x.value,x.value.id).then(()=>{b.value=!1,g("successful")}).finally(()=>{y.value=!1})}).catch(()=>{})},O={orgTreeApi:e=>r.orgTreeSelector(e).then(e=>Promise.resolve(e)),userPageApi:e=>r.orgUserSelector(e).then(e=>Promise.resolve(e))};return v({onOpen:(e,a)=>{if(b.value=!0,x.value={sortCode:99},a&&(x.value.parentId=a),e){const a={id:e.id};r.orgDetail(a).then(e=>{x.value=Object.assign({},e)})}r.orgTreeSelector().then(e=>{_.value=[{id:0,parentId:"-1",name:"顶级",children:e}]})}}),(l,r)=>{const t=n("a-tree-select"),o=n("a-form-item"),s=n("a-input"),v=n("a-select"),f=n("a-input-number"),g=a,A=n("a-form"),U=n("a-button"),T=e;return i(),d(T,{title:p(x).id?"编辑机构":"增加机构",width:550,visible:p(b),"destroy-on-close":!0,onClose:j},{footer:u(()=>[m(U,{class:"xn-mr8",onClick:j},{default:u(()=>r[5]||(r[5]=[c("关闭")])),_:1}),m(U,{type:"primary",loading:p(y),onClick:w},{default:u(()=>r[6]||(r[6]=[c("保存")])),_:1},8,["loading"])]),default:u(()=>[m(A,{ref_key:"formRef",ref:h,model:p(x),rules:C,layout:"vertical"},{default:u(()=>[m(o,{label:"上级机构：",name:"parentId"},{default:u(()=>[m(t,{value:p(x).parentId,"onUpdate:value":r[0]||(r[0]=e=>p(x).parentId=e),class:"xn-wd","dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择上级机构","allow-clear":"","tree-default-expand-all":"","tree-data":p(_),"field-names":{children:"children",label:"name",value:"id"},selectable:"false","tree-line":""},null,8,["value","tree-data"])]),_:1}),m(o,{label:"机构名称：",name:"name"},{default:u(()=>[m(s,{value:p(x).name,"onUpdate:value":r[1]||(r[1]=e=>p(x).name=e),placeholder:"请输入机构名称","allow-clear":""},null,8,["value"])]),_:1}),m(o,{label:"机构分类：",name:"category"},{default:u(()=>[m(v,{value:p(x).category,"onUpdate:value":r[2]||(r[2]=e=>p(x).category=e),options:p(I),class:"xn-wd",placeholder:"请选择机构分类"},null,8,["value","options"])]),_:1}),m(o,{label:"排序：",name:"sortCode"},{default:u(()=>[m(f,{class:"xn-wd",value:p(x).sortCode,"onUpdate:value":r[3]||(r[3]=e=>p(x).sortCode=e),max:100},null,8,["value"])]),_:1}),m(o,{label:"指定主管：",name:"directorId"},{default:u(()=>[m(g,{"org-tree-api":O.orgTreeApi,"user-page-api":O.userPageApi,"radio-model":!0,value:p(x).directorId,"onUpdate:value":r[4]||(r[4]=e=>p(x).directorId=e)},null,8,["org-tree-api","user-page-api","value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","visible"])}}});export{f as default};
