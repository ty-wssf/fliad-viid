import{_ as e}from"./index-CkDqqgfU.js";import{_ as a}from"./index-r8v7tfQO.js";import{r}from"./roleApi-AgyZA8--.js";import{o as l}from"./orgApi-CJS79xlv.js";import o from"./grantResourceForm-bNFmi5F_.js";import t from"./grantMobileResourceForm-B5lT3Kqa.js";import n from"./grantPermissionForm-BrXT393J.js";import s from"./form-BVN7dIYI.js";import{_ as d}from"./index-DcffTgQN.js";import{w as i,x as u}from"./ant-design-vendor-CRFwT3Wn.js";import{d as c,f,a1 as m,U as p,V as g,k as h,a2 as y,u as v,a6 as _,H as k,G as w,Z as x,F as b,a3 as C,Y as O}from"./vue-vendor-BzDj5Url.js";import"./index-yhO5Pkur.js";import"./scopeDefineOrg-BU3kPQ6q.js";import"./treeHandler-B8ofjH1e.js";import"./formRules-B2bzcXv4.js";const R=["onClick"],j={class:"ant-dropdown-link"},I=["onClick"],S=["onClick"],P=["onClick"],A=["onClick"],E=c({name:"sysRole"}),F=d(Object.assign(E,{setup(d){const c=[{title:"角色名称",dataIndex:"name",resizable:!0,width:150},{title:"分类",dataIndex:"category"},{title:"排序",dataIndex:"sortCode",width:100},{title:"操作",dataIndex:"action",align:"center",width:"200px"}],E=f([]),F={alert:{show:!1,clear:()=>{E.value=f([])}},rowSelection:{onChange:(e,a)=>{E.value=e}}},D=f(),K=f(),L=f(),T=f(),G=f(),U=f(),B=f(),M=f({}),z=f([]),H=f([]),N={children:"children",title:"name",key:"id"},Y=f(!0),V=f({}),Z=e=>{let a=Object.assign(e,M.value);return r.rolePage(a).then(e=>e)},$=()=>{B.value.resetFields(),D.value.refresh(!0)};l.orgTree().then(e=>{if(Y.value=!1,null!==e){const a=[{id:"GLOBAL",parentId:"-1",name:"全局"}];H.value=a.concat(e),i(z.value)&&H.value.forEach(e=>{"0"===e.parentId&&(z.value.push(e.id),e.children&&e.children.forEach(e=>{z.value.push(e.id)}))})}});const q=e=>{e.length>0?"GLOBAL"===e[0]?(M.value.category=e[0],delete M.value.orgId):(M.value.orgId=e.toString(),delete M.value.category):(delete M.value.category,delete M.value.orgId),D.value.refresh(!0)},J=(e,a)=>{a.width=e},Q=e=>{r.roleDelete(e).then(()=>{D.value.clearRefreshSelected()})},W=e=>{const a={id:V.value.id,grantInfoList:e};r.roleGrantUser(a).then(()=>{})},X={orgTreeApi:e=>r.roleOrgTreeSelector(e).then(e=>Promise.resolve(e)),userPageApi:e=>r.roleUserSelector(e).then(e=>Promise.resolve(e))};return(l,d)=>{const i=m("a-tree"),f=m("a-empty"),ee=m("a-card"),ae=m("a-col"),re=m("a-input"),le=m("a-form-item"),oe=m("SearchOutlined"),te=m("a-button"),ne=m("redo-outlined"),se=m("a-row"),de=m("a-form"),ie=m("plus-outlined"),ue=a,ce=m("a-space"),fe=m("a-divider"),me=m("a-popconfirm"),pe=m("DownOutlined"),ge=m("a-menu-item"),he=m("a-menu"),ye=m("a-dropdown"),ve=m("s-table"),_e=e;return g(),p(b,null,[h(se,{gutter:10},{default:y(()=>[h(ae,{xs:24,sm:24,md:24,lg:5,xl:5},{default:y(()=>[h(ee,{bordered:!1,loading:v(Y),class:"left-tree-container"},{default:y(()=>[v(H).length>0?(g(),_(i,{key:0,expandedKeys:v(z),"onUpdate:expandedKeys":d[0]||(d[0]=e=>k(z)?z.value=e:null),"tree-data":v(H),"field-names":N,onSelect:q},null,8,["expandedKeys","tree-data"])):(g(),_(f,{key:1,image:v(u).PRESENTED_IMAGE_SIMPLE},null,8,["image"]))]),_:1},8,["loading"])]),_:1}),h(ae,{xs:24,sm:24,md:24,lg:19,xl:19},{default:y(()=>[h(ee,{bordered:!1,class:"xn-mb10"},{default:y(()=>[h(de,{ref_key:"searchFormRef",ref:B,name:"advanced_search",class:"ant-advanced-search-form",model:v(M)},{default:y(()=>[h(se,{gutter:24},{default:y(()=>[h(ae,{span:8},{default:y(()=>[h(le,{name:"searchKey",label:"名称关键词"},{default:y(()=>[h(re,{value:v(M).searchKey,"onUpdate:value":d[1]||(d[1]=e=>v(M).searchKey=e),placeholder:"请输入角色名称关键词"},null,8,["value"])]),_:1})]),_:1}),h(ae,{span:8},{default:y(()=>[h(te,{type:"primary",onClick:d[2]||(d[2]=e=>v(D).refresh(!0))},{icon:y(()=>[h(oe)]),default:y(()=>[d[8]||(d[8]=w(" 查询 "))]),_:1}),h(te,{class:"snowy-button-left",onClick:$},{icon:y(()=>[h(ne)]),default:y(()=>[d[9]||(d[9]=w(" 重置 "))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),h(ee,{bordered:!1},{default:y(()=>[h(ve,{ref_key:"tableRef",ref:D,columns:c,data:Z,"expand-row-by-click":!0,alert:F.alert.show,bordered:"","row-key":e=>e.id,"row-selection":F.rowSelection,onResizeColumn:J},{operator:y(()=>[h(ce,null,{default:y(()=>[h(te,{type:"primary",onClick:d[3]||(d[3]=e=>v(K).onOpen(void 0,v(M).category,v(M).orgId))},{icon:y(()=>[h(ie)]),default:y(()=>[d[10]||(d[10]=w(" 新增角色 "))]),_:1}),h(ue,{buttonName:"批量删除",icon:"DeleteOutlined",buttonDanger:"",selectedRowKeys:v(E),onBatchCallBack:Q},null,8,["selectedRowKeys"])]),_:1})]),bodyCell:y(({column:e,record:a})=>["category"===e.dataIndex?(g(),p(b,{key:0},[w(C(l.$TOOL.dictTypeData("ROLE_CATEGORY",a.category)),1)],64)):x("",!0),"action"===e.dataIndex?(g(),p(b,{key:1},[O("a",{onClick:e=>v(K).onOpen(a)},"编辑",8,R),h(fe,{type:"vertical"}),h(me,{title:"确定删除此角色？",onConfirm:e=>(e=>{let a=[{id:e.id}];r.roleDelete(a).then(()=>{D.value.refresh(!0)})})(a)},{default:y(()=>[h(te,{type:"link",danger:"",size:"small"},{default:y(()=>d[11]||(d[11]=[w("删除")])),_:1})]),_:2},1032,["onConfirm"]),h(fe,{type:"vertical"}),h(ye,null,{overlay:y(()=>[h(he,null,{default:y(()=>[h(ge,null,{default:y(()=>[O("a",{onClick:e=>v(L).onOpen(a)},"授权资源",8,I)]),_:2},1024),h(ge,null,{default:y(()=>[O("a",{onClick:e=>v(T).onOpen(a)},"授权移动端资源",8,S)]),_:2},1024),h(ge,null,{default:y(()=>[O("a",{onClick:e=>v(G).onOpen(a)},"授权权限",8,P)]),_:2},1024),h(ge,null,{default:y(()=>[O("a",{onClick:e=>(e=>{V.value=e;const a={id:e.id};r.roleOwnUser(a).then(e=>{U.value.showUserPlusModal(e)})})(a)},"授权用户",8,A)]),_:2},1024)]),_:2},1024)]),default:y(()=>[O("a",j,[d[12]||(d[12]=w(" 授权 ")),h(pe)])]),_:2},1024)],64)):x("",!0)]),_:1},8,["alert","row-key","row-selection"])]),_:1})]),_:1})]),_:1}),h(o,{ref_key:"grantResourceFormRef",ref:L,onSuccessful:d[4]||(d[4]=e=>v(D).refresh())},null,512),h(t,{ref_key:"grantMobileResourceFormRef",ref:T,onSuccessful:d[5]||(d[5]=e=>v(D).refresh())},null,512),h(n,{ref_key:"grantPermissionFormRef",ref:G,onSuccessful:d[6]||(d[6]=e=>v(D).refresh())},null,512),h(s,{ref_key:"formRef",ref:K,onSuccessful:d[7]||(d[7]=e=>v(D).refresh())},null,512),h(_e,{ref_key:"userSelectorPlusRef",ref:U,"org-tree-api":X.orgTreeApi,"user-page-api":X.userPageApi,"data-type":"object","user-show":!1,onOnBack:W},null,8,["org-tree-api","user-page-api"])],64)}}}),[["__scopeId","data-v-99c5e631"]]);export{F as default};
