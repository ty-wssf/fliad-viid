import{c as e}from"./configApi-BMiyCPj3.js";import{k as t,J as a}from"./ant-design-vendor-CRFwT3Wn.js";import{d as n,f as o,a1 as l,a6 as s,V as i,a2 as d,k as p,Y as r,u as c,Z as u,U as m,a3 as g,G as f}from"./vue-vendor-BzDj5Url.js";import"./index-DcffTgQN.js";const C={key:1,class:"flex items-center"},v={class:"pt-3"},k=n({name:"bForm"}),y=Object.assign(k,{setup(n){o(),o({});const k=o(!1),y=o(!0),x=o([]),I=[{title:"名称",dataIndex:"remark",key:"remark"},{title:"模板内容",dataIndex:"templateContent",key:"templateContent"},{title:"模板ID/CODE",dataIndex:"templateCode",key:"templateCode"}];e.configList({category:"SMS_TEMPLATE_FOR_B"}).then(e=>{y.value=!1,e?x.value=e.map(e=>{const t=JSON.parse(e.configValue);return{...e,templateCode:t.code,templateContent:t.content}}):t.warning("表单项不存在，请初始化数据库")});return(n,o)=>{const _=l("a-input"),b=l("a-button"),S=l("a-table"),j=l("a-spin");return i(),s(j,{spinning:c(y)},{default:d(()=>[p(S,{dataSource:c(x),columns:I,pagination:!1,bordered:"",size:"middle"},{bodyCell:d(({text:e,record:n,column:o})=>["templateCode"===o.dataIndex?(i(),s(_,{key:0,value:n.templateCode,"onUpdate:value":e=>n.templateCode=e,onInput:e=>((e,a)=>{const n=e.target.value;/[\u4e00-\u9fa5]/.test(n)&&(a.templateCode=n.replace(/[\u4e00-\u9fa5]/g,""),t.warning("不能输入汉字"))})(e,n),placeholder:"请输入模板号"},null,8,["value","onUpdate:value","onInput"])):u("",!0),"templateContent"===o.dataIndex?(i(),m("div",C,[r("span",null,g(e),1),p(b,{type:"link",onClick:a=>(e=>{navigator.clipboard.writeText(e).then(()=>{t.success("复制成功")})})(e)},{icon:d(()=>[p(c(a))]),_:2},1032,["onClick"])])):u("",!0)]),_:1},8,["dataSource"]),r("div",v,[p(b,{type:"primary",loading:c(k),onClick:o[0]||(o[0]=t=>(()=>{k.value=!0;const t=x.value.map(e=>({configKey:e.configKey,configValue:JSON.stringify({code:e.templateCode,content:e.templateContent})}));e.configEditForm(t).then(()=>{}).finally(()=>{k.value=!1})})())},{default:d(()=>o[2]||(o[2]=[f("保存")])),_:1},8,["loading"]),p(b,{class:"xn-ml10",onClick:o[1]||(o[1]=()=>{x.value=x.value.map(e=>({...e,templateCode:""}))})},{default:d(()=>o[3]||(o[3]=[f("重置")])),_:1})])]),_:1},8,["spinning"])}}});export{y as default};
