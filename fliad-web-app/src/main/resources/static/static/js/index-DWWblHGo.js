import{_ as e,e as a,t}from"./index-DcffTgQN.js";import l from"./form-ChjbYbc9.js";import{d,c as r,f as n,a1 as o,U as s,V as i,k as c,a2 as u,Y as f,a6 as p,u as m,H as y,G as h,Z as v,F as _,a3 as g}from"./vue-vendor-BzDj5Url.js";import{x}from"./ant-design-vendor-CRFwT3Wn.js";import"./index-yhO5Pkur.js";import"./formRules-B2bzcXv4.js";const k={class:"left-tree-container"},I=["onClick"],b=d({name:"dictCategoryIndex"}),C=e(Object.assign(b,{props:{type:{type:String,default:"FRM"}},setup(e){const d=e,b=[{title:"字典名称",dataIndex:"dictLabel",width:350},{title:"字典值",dataIndex:"dictValue",width:350},{title:"排序",dataIndex:"sortCode"},{title:"操作",dataIndex:"action",align:"center",width:"150px"}],C=r(()=>d.type),E=n(null),w=n(),j=n(),S=n({});let R=n([]);const T=n([]),K={children:"children",title:"dictLabel",key:"id"},O={refresh:!0,height:!0,columnSetting:!0,striped:!1},D=e=>(P(),e.category=C.value,a.dictPage(Object.assign(e,S.value)).then(e=>{if(e.records&&S.value.parentId){let a=[];e.records.forEach(t=>{e.records.find(e=>e.id===t.parentId)||a.push(t)}),1===a.length&&e.records.forEach(e=>{e.id===a[0].id&&(e.level="上级")}),a=[]}return e})),F=()=>{j.value.resetFields(),E.value.refresh(!0)},P=()=>{const e={category:C.value};a.dictTree(e).then(e=>{e&&(T.value=e)})},A=e=>{e&&e.length>0?(S.value.parentId=e.toString(),b.find(e=>"层级"===e.title)||b.splice(2,0,{title:"层级",dataIndex:"level",width:100})):(delete S.value.parentId,b.splice(2,1)),E.value.refresh(!0)},L=()=>{a.dictTree().then(e=>{t.data.set("DICT_TYPE_TREE_DATA",e)})};return(e,t)=>{const d=o("a-tree"),r=o("a-empty"),n=o("a-col"),P=o("a-input"),M=o("a-form-item"),U=o("SearchOutlined"),G=o("a-button"),V=o("redo-outlined"),Y=o("a-row"),z=o("a-form"),H=o("a-divider"),J=o("plus-outlined"),N=o("a-tag"),Z=o("a-popconfirm"),q=o("s-table");return i(),s(_,null,[c(Y,{gutter:10},{default:u(()=>[c(n,{xs:24,sm:24,md:24,lg:5,xl:5},{default:u(()=>[f("div",k,[m(T).length>0?(i(),p(d,{key:0,expandedKeys:m(R),"onUpdate:expandedKeys":t[0]||(t[0]=e=>y(R)?R.value=e:R=e),"tree-data":m(T),"field-names":K,onSelect:A},null,8,["expandedKeys","tree-data"])):(i(),p(r,{key:1,image:m(x).PRESENTED_IMAGE_SIMPLE},null,8,["image"]))])]),_:1}),c(n,{xs:24,sm:24,md:24,lg:19,xl:19},{default:u(()=>[c(z,{ref_key:"searchFormRef",ref:j,name:"advanced_search",class:"ant-advanced-search-form mb-3",model:m(S)},{default:u(()=>[c(Y,{gutter:24},{default:u(()=>[c(n,{span:8},{default:u(()=>[c(M,{name:"searchKey",label:"字典名称"},{default:u(()=>[c(P,{value:m(S).searchKey,"onUpdate:value":t[1]||(t[1]=e=>m(S).searchKey=e),placeholder:"请输入字典名称"},null,8,["value"])]),_:1})]),_:1}),c(n,{span:8},{default:u(()=>[c(G,{type:"primary",onClick:t[2]||(t[2]=e=>m(E).refresh(!0))},{icon:u(()=>[c(U)]),default:u(()=>[t[5]||(t[5]=h(" 查询 "))]),_:1}),c(G,{class:"snowy-button-left",onClick:F},{icon:u(()=>[c(V)]),default:u(()=>[t[6]||(t[6]=h(" 重置 "))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),c(H,{class:"m-3 mx-0"}),c(q,{ref_key:"tableRef",ref:E,columns:b,data:D,"expand-row-by-click":!0,bordered:"","tool-config":O,"row-key":e=>e.id},{operator:u(()=>[c(G,{type:"primary",onClick:t[3]||(t[3]=e=>m(w).onOpen(void 0,m(C),m(S).parentId))},{icon:u(()=>[c(J)]),default:u(()=>[t[7]||(t[7]=h(" 新增 "))]),_:1})]),bodyCell:u(({column:e,record:l})=>["level"===e.dataIndex?(i(),s(_,{key:0},[l.level?(i(),p(N,{key:0,color:"blue"},{default:u(()=>[h(g(l.level),1)]),_:2},1024)):(i(),p(N,{key:1,color:"green"},{default:u(()=>t[8]||(t[8]=[h("子级")])),_:1}))],64)):v("",!0),"action"===e.dataIndex?(i(),s(_,{key:1},[f("a",{onClick:e=>m(w).onOpen(l,m(C))},"编辑",8,I),c(H,{type:"vertical"}),c(Z,{title:"删除此字典与下级字典吗？",onConfirm:e=>(e=>{let t=[{id:e.id}];a.dictDelete(t).then(()=>{E.value.refresh(),L()})})(l)},{default:u(()=>[c(G,{type:"link",danger:"",size:"small"},{default:u(()=>t[9]||(t[9]=[h("删除")])),_:1})]),_:2},1032,["onConfirm"])],64)):v("",!0)]),_:1},8,["row-key"])]),_:1})]),_:1}),c(l,{ref_key:"formRef",ref:w,onSuccessful:t[4]||(t[4]=e=>(E.value.refresh(),void L()))},null,512)],64)}}}),[["__scopeId","data-v-0b681908"]]);export{C as default};
