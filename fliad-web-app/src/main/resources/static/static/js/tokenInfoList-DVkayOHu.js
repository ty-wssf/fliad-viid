import{_ as e}from"./index-yhO5Pkur.js";import{m as t}from"./monitorApi-DqZEyMqC.js";import{i as o}from"./index-DcffTgQN.js";import{b as a}from"./ant-design-vendor-CRFwT3Wn.js";import{f as n,a1 as l,a6 as i,V as u,a2 as s,k as r,u as c,G as d,U as k,Z as m,F as v,a3 as p}from"./vue-vendor-BzDj5Url.js";const f={__name:"tokenInfoList",emits:{successful:null},setup(f,{expose:T,emit:h}){const x=[{title:"登录设备",dataIndex:"tokenDevice",width:90},{title:"有效期",dataIndex:"tokenTimeout"},{title:"令牌",dataIndex:"tokenValue",ellipsis:!0,width:80}];o("authForceQuit")&&x.push({title:"操作",dataIndex:"action",align:"center",width:"100px",scopedSlots:{customRender:"action"}});const _=n([]),y=n(!1),E=n([]),D=n(!1),I=n(!1),V=n(),g=h,P=()=>{_.value=[],V.value="",y.value=!1},C={onChange:e=>{E.value=e}},b=()=>{let e=[];E.value.forEach(t=>{e.push({tokenValue:t})}),I.value=!0,"B"===V.value?t.monitorTokenBExit(e).then(()=>{w(e),E.value=[],I.value=!1}):t.monitorTokenCExit(e).then(()=>{w(e),E.value=[],I.value=!1})},w=e=>{_.value.forEach((t,o,a)=>{e.forEach(e=>{t.tokenValue===e.tokenValue&&delete a[o]})}),g("successful")};return T({onOpen:(e,t)=>{V.value=t,_.value=a(e),y.value=!0}}),(o,a)=>{const n=l("a-button"),f=l("a-tag"),T=l("a-progress"),h=l("a-tooltip"),g=l("a-popconfirm"),O=l("a-table"),j=e;return u(),i(j,{title:"令牌列表",width:650,visible:c(y),"destroy-on-close":!0,onClose:P},{default:s(()=>[r(n,{danger:"",class:"xn-mb10",disabled:0===c(E).length,loading:c(I),onClick:b},{default:s(()=>a[0]||(a[0]=[d("批量强退")])),_:1},8,["disabled","loading"]),r(O,{columns:x,"data-source":c(_),"row-selection":C,bordered:"","row-key":e=>e.tokenValue,size:"small"},{bodyCell:s(({column:e,record:l})=>["tokenDevice"===e.dataIndex?(u(),k(v,{key:0},["PC"===l.tokenDevice?(u(),i(f,{key:0,color:"blue"},{default:s(()=>[d(p(o.$TOOL.dictTypeData("AUTH_DEVICE_TYPE",l.tokenDevice)),1)]),_:2},1024)):m("",!0),"APP"===l.tokenDevice?(u(),i(f,{key:1,color:"purple"},{default:s(()=>[d(p(o.$TOOL.dictTypeData("AUTH_DEVICE_TYPE",l.tokenDevice)),1)]),_:2},1024)):m("",!0),"MINI"===l.tokenDevice?(u(),i(f,{key:2,color:"orange"},{default:s(()=>[d(p(o.$TOOL.dictTypeData("AUTH_DEVICE_TYPE",l.tokenDevice)),1)]),_:2},1024)):m("",!0)],64)):m("",!0),"tokenTimeout"===e.dataIndex?(u(),i(h,{key:1},{title:s(()=>[d(p(l.tokenTimeout),1)]),default:s(()=>[100*l.tokenTimeoutPercent>80?(u(),i(T,{key:0,percent:100*l.tokenTimeoutPercent,"show-info":!1,status:"success"},null,8,["percent"])):m("",!0),100*l.tokenTimeoutPercent>20&&100*l.tokenTimeoutPercent<80?(u(),i(T,{key:1,percent:100*l.tokenTimeoutPercent,"show-info":!1,status:"active"},null,8,["percent"])):m("",!0),100*l.tokenTimeoutPercent<20?(u(),i(T,{key:2,percent:100*l.tokenTimeoutPercent,"show-info":!1,status:"exception"},null,8,["percent"])):m("",!0)]),_:2},1024)):m("",!0),"tokenValue"===e.dataIndex?(u(),i(h,{key:2},{title:s(()=>[d(p(l.tokenValue),1)]),default:s(()=>[d(" "+p(l.tokenValue),1)]),_:2},1024)):m("",!0),"action"===e.dataIndex?(u(),i(g,{key:3,title:"确定要强退此令牌吗？",onConfirm:e=>(e=>{let o=[{tokenValue:e.tokenValue}];D.value=!0,"B"===V.value?t.monitorTokenBExit(o).then(()=>{w(o),D.value=!1}):t.monitorTokenCExit(o).then(()=>{w(o),D.value=!1})})(l)},{default:s(()=>[r(n,{type:"link",danger:"",size:"small",loading:c(D)},{default:s(()=>a[1]||(a[1]=[d("强退")])),_:1},8,["loading"])]),_:2},1032,["onConfirm"])):m("",!0)]),_:1},8,["data-source","row-key"])]),_:1},8,["visible"])}}};export{f as default};
