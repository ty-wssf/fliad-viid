import{_ as e}from"./index-r8v7tfQO.js";import{_ as a,v as t}from"./form-BqfOGKkq.js";import{_ as l}from"./designWorkflow.vue_vue_type_script_setup_true_name_viidWorkflowForm_lang-B04OvMZa.js";import{i as r}from"./index-DcffTgQN.js";import{k as o}from"./ant-design-vendor-CRFwT3Wn.js";import{d as i,r as s,f as n,a1 as d,U as f,V as c,k as u,a2 as k,u as m,G as p,Z as h,a6 as v,F as y,W as w,a3 as _,Y as g}from"./vue-vendor-BzDj5Url.js";import"./formRules-B2bzcXv4.js";const b=["onClick"],W=["onClick"],C=["onClick"],x=i({name:"workflow"}),D=Object.assign(x,{setup(i){let x=s({});const D=n(),I=n(),O=n(),S=n(),j={refresh:!0,height:!0,columnSetting:!0,striped:!1},E=n(!1),R=[{title:"ID",dataIndex:"id"},{title:"标题",dataIndex:"title"},{title:"订阅类别",dataIndex:"subscribeDetail"},{title:"状态",dataIndex:"status"},{title:"备注",dataIndex:"remark",ellipsis:!0}];r(["viidWorkflowEdit","viidWorkflowDelete"])&&R.push({title:"操作",dataIndex:"action",align:"center",width:"240px"});let N=n([]);const P={alert:{show:!1,clear:()=>{N=n([])}},rowSelection:{onChange:(e,a)=>{N.value=e}}},B=e=>{const a=JSON.parse(JSON.stringify(x));return t.viidWorkflowPage(Object.assign(e,a)).then(e=>e)},F=()=>{if(N.value.length<1)return o.warning("请选择一条或多条数据"),!1;const e=N.value.map(e=>({id:e}));t.viidWorkflowDelete(e).then(()=>{I.value.clearRefreshSelected()})};return(r,i)=>{const s=d("a-input"),n=d("a-form-item"),L=d("a-col"),A=d("a-button"),J=d("a-row"),T=d("a-form"),K=d("plus-outlined"),U=e,V=d("a-space"),z=d("a-tag"),G=d("a-switch"),X=d("a-divider"),Y=d("a-popconfirm"),Z=d("s-table"),$=d("a-card");return c(),f(y,null,[u($,{bordered:!1},{default:k(()=>[u(T,{ref_key:"searchFormRef",ref:D,name:"advanced_search",model:m(x),class:"ant-advanced-search-form mb-4"},{default:k(()=>[u(J,{gutter:24},{default:k(()=>[u(L,{span:6},{default:k(()=>[u(n,{label:"标题",name:"title"},{default:k(()=>[u(s,{value:m(x).title,"onUpdate:value":i[0]||(i[0]=e=>m(x).title=e),placeholder:"请输入标题"},null,8,["value"])]),_:1})]),_:1}),u(L,{span:6},{default:k(()=>[u(A,{type:"primary",onClick:i[1]||(i[1]=e=>m(I).refresh(!0))},{default:k(()=>i[6]||(i[6]=[p("查询")])),_:1}),u(A,{style:{margin:"0 8px"},onClick:i[2]||(i[2]=()=>m(D).resetFields())},{default:k(()=>i[7]||(i[7]=[p("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),u(Z,{ref_key:"table",ref:I,columns:R,data:B,alert:P.alert.show,bordered:"","row-key":e=>e.id,"tool-config":j,"row-selection":P.rowSelection},{operator:k(()=>[u(V,null,{default:k(()=>[r.hasPerm("viidWorkflowAdd")?(c(),v(A,{key:0,type:"primary",onClick:i[3]||(i[3]=e=>m(O).onOpen())},{icon:k(()=>[u(K)]),default:k(()=>[i[8]||(i[8]=p(" 新增 "))]),_:1})):h("",!0),r.hasPerm("viidWorkflowBatchDelete")?(c(),v(U,{key:1,buttonName:"批量删除",icon:"DeleteOutlined",selectedRowKeys:m(N),onBatchCallBack:F},null,8,["selectedRowKeys"])):h("",!0)]),_:1})]),bodyCell:k(({column:e,record:a})=>["subscribeDetail"===e.dataIndex?(c(!0),f(y,{key:0},w(JSON.parse(a.subscribeDetail),e=>(c(),v(z,{key:e,color:"processing"},{default:k(()=>[p(_(r.$TOOL.dictTypeData("VIID_Subscribe_Detail_Type",e)),1)]),_:2},1024))),128)):h("",!0),"status"===e.dataIndex?(c(),v(G,{key:1,loading:m(E),checked:"ENABLE"===a.status,onChange:e=>(e=>{E.value=!0,"ENABLE"===e.status?t.disableWorkflow(e).then(()=>{I.value.refresh(!0)}).finally(()=>{E.value=!1}):t.enableWorkflow(e).then(()=>{I.value.refresh(!0)}).finally(()=>{E.value=!1})})(a)},null,8,["loading","checked","onChange"])):h("",!0),"action"===e.dataIndex?(c(),f(y,{key:2},[r.hasPerm("viidWorkflowEdit")?(c(),f("a",{key:0,onClick:e=>m(O).onOpen(a)},"编辑",8,b)):h("",!0),r.hasPerm(["viidWorkflowEdit","viidWorkflowDelete"],"and")?(c(),v(X,{key:1,type:"vertical"})):h("",!0),u(Y,{title:"确定要删除吗？",onConfirm:e=>(e=>{let a=[{id:e.id}];t.viidWorkflowDelete(a).then(()=>{I.value.refresh(!0)})})(a)},{default:k(()=>[r.hasPerm("viidWorkflowDelete")?(c(),v(A,{key:0,type:"link",danger:"",size:"small"},{default:k(()=>i[9]||(i[9]=[p("删除")])),_:1})):h("",!0)]),_:2},1032,["onConfirm"]),u(X,{type:"vertical"}),g("a",{onClick:e=>(e=>{let a={id:e.id};t.viidWorkflowCopy(a).then(()=>{I.value.refresh(!0),o.success("复制成功")})})(a)},"复制",8,W),u(X,{type:"vertical"}),g("a",{onClick:e=>m(S).onOpen(a)},"设计工作流",8,C)],64)):h("",!0)]),_:1},8,["alert","row-key","row-selection"])]),_:1}),u(a,{ref_key:"formRef",ref:O,onSuccessful:i[4]||(i[4]=e=>m(I).refresh(!0))},null,512),u(l,{ref_key:"designWorkflowRef",ref:S,onSuccessful:i[5]||(i[5]=e=>m(I).refresh(!0))},null,512)],64)}}});export{D as default};
