import{_ as e}from"./index-r8v7tfQO.js";import{o as a}from"./orgApi-CJS79xlv.js";import t from"./form-wPjcTy1A.js";import{_ as l}from"./index-DcffTgQN.js";import{x as r,w as n}from"./ant-design-vendor-CRFwT3Wn.js";import{d as o,f as d,a1 as s,U as i,V as u,k as c,a2 as f,u as m,a6 as p,H as h,G as y,Z as v,F as _,a3 as g,Y as x}from"./vue-vendor-BzDj5Url.js";import"./index-yhO5Pkur.js";import"./index-CkDqqgfU.js";import"./formRules-B2bzcXv4.js";const b=["onClick"],k=o({name:"sysOrg"}),w=l(Object.assign(k,{setup(l){const o=[{title:"组织名称",dataIndex:"name"},{title:"分类",dataIndex:"category"},{title:"排序",dataIndex:"sortCode",width:100},{title:"操作",dataIndex:"action",align:"center",width:"150px"}],k=d([]),w={alert:{show:!1,clear:()=>{k.value=d([])}},rowSelection:{onChange:(e,a)=>{k.value=e}}},I=d(null),C=d(),j=d(),O=d({}),R=d([]),E=d([]),S={children:"children",title:"name",key:"id"},K=d(!0),D=e=>(G(),a.orgPage(Object.assign(e,O.value)).then(e=>e)),T=()=>{j.value.resetFields(),I.value.refresh(!0)},G=()=>{a.orgTree().then(e=>{K.value=!1,null!==e&&(E.value=e,n(R.value)&&E.value.forEach(e=>{"0"===e.parentId&&(R.value.push(e.id),e.children&&e.children.forEach(e=>{R.value.push(e.id)}))}))})},A=e=>{e.length>0?O.value.parentId=e.toString():delete O.value.parentId,I.value.refresh(!0)},F=e=>{a.orgDelete(e).then(()=>{I.value.clearRefreshSelected()})};return(l,n)=>{const d=s("a-tree"),G=s("a-empty"),P=s("a-card"),U=s("a-col"),B=s("a-input"),L=s("a-form-item"),M=s("SearchOutlined"),N=s("a-button"),Y=s("redo-outlined"),$=s("a-row"),z=s("a-form"),H=s("plus-outlined"),V=e,Z=s("a-space"),q=s("a-divider"),J=s("a-popconfirm"),Q=s("s-table");return u(),i(_,null,[c($,{gutter:10},{default:f(()=>[c(U,{xs:24,sm:24,md:24,lg:5,xl:5},{default:f(()=>[c(P,{bordered:!1,loading:m(K),class:"left-tree-container"},{default:f(()=>[m(E).length>0?(u(),p(d,{key:0,expandedKeys:m(R),"onUpdate:expandedKeys":n[0]||(n[0]=e=>h(R)?R.value=e:null),"tree-data":m(E),"field-names":S,onSelect:A},null,8,["expandedKeys","tree-data"])):(u(),p(G,{key:1,image:m(r).PRESENTED_IMAGE_SIMPLE},null,8,["image"]))]),_:1},8,["loading"])]),_:1}),c(U,{xs:24,sm:24,md:24,lg:19,xl:19},{default:f(()=>[c(P,{bordered:!1,class:"xn-mb10"},{default:f(()=>[c(z,{ref_key:"searchFormRef",ref:j,name:"advanced_search",class:"ant-advanced-search-form",model:m(O)},{default:f(()=>[c($,{gutter:24},{default:f(()=>[c(U,{span:8},{default:f(()=>[c(L,{name:"searchKey",label:"名称关键词"},{default:f(()=>[c(B,{value:m(O).searchKey,"onUpdate:value":n[1]||(n[1]=e=>m(O).searchKey=e),placeholder:"请输入组织名称关键词"},null,8,["value"])]),_:1})]),_:1}),c(U,{span:8},{default:f(()=>[c(N,{type:"primary",onClick:n[2]||(n[2]=e=>m(I).refresh(!0))},{icon:f(()=>[c(M)]),default:f(()=>[n[5]||(n[5]=y(" 查询 "))]),_:1}),c(N,{class:"snowy-button-left",onClick:T},{icon:f(()=>[c(Y)]),default:f(()=>[n[6]||(n[6]=y(" 重置 "))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),c(P,{bordered:!1},{default:f(()=>[c(Q,{ref_key:"tableRef",ref:I,columns:o,data:D,"expand-row-by-click":!0,alert:w.alert.show,bordered:"","row-key":e=>e.id,"row-selection":w.rowSelection},{operator:f(()=>[c(Z,null,{default:f(()=>[c(N,{type:"primary",onClick:n[3]||(n[3]=e=>m(C).onOpen(void 0,m(O).parentId))},{icon:f(()=>[c(H)]),default:f(()=>[n[7]||(n[7]=y(" 新增 "))]),_:1}),c(V,{buttonName:"批量删除",icon:"DeleteOutlined",buttonDanger:"",selectedRowKeys:m(k),onBatchCallBack:F},null,8,["selectedRowKeys"])]),_:1})]),bodyCell:f(({column:e,record:t})=>["category"===e.dataIndex?(u(),i(_,{key:0},[y(g(l.$TOOL.dictTypeData("ORG_CATEGORY",t.category)),1)],64)):v("",!0),"action"===e.dataIndex?(u(),i(_,{key:1},[x("a",{onClick:e=>m(C).onOpen(t)},"编辑",8,b),c(q,{type:"vertical"}),c(J,{title:"删除此组织与下级组织吗？",onConfirm:e=>(e=>{let t=[{id:e.id}];a.orgDelete(t).then(()=>{I.value.refresh(!0)})})(t)},{default:f(()=>[c(N,{type:"link",danger:"",size:"small"},{default:f(()=>n[8]||(n[8]=[y("删除")])),_:1})]),_:2},1032,["onConfirm"])],64)):v("",!0)]),_:1},8,["alert","row-key","row-selection"])]),_:1})]),_:1})]),_:1}),c(t,{ref_key:"formRef",ref:C,onSuccessful:n[4]||(n[4]=e=>m(I).refresh())},null,512)],64)}}}),[["__scopeId","data-v-40d7b28b"]]);export{w as default};
