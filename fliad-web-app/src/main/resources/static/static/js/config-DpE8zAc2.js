import{h as e,_ as a,t}from"./index-DcffTgQN.js";import{b as l}from"./ant-design-vendor-CRFwT3Wn.js";import{d,f as n,a1 as i,a6 as r,V as c,a2 as h,k as o,Z as u,U as p,u as s,F as f,G as y,a3 as b,n as v}from"./vue-vendor-BzDj5Url.js";const k=(a,...t)=>e("/gen/config/"+a,...t),w={configList:e=>k("list",e,"get"),submitForm:(e,a=!1)=>k(a?"edit":"add",e),configDelete:e=>k("delete",e),configDetail:e=>k("detail",e,"get"),configEditBatch:e=>k("editBatch",e)},g={key:1},T={key:1},x={key:2},U=d({name:"genConfig"}),m=a(Object.assign(U,{emits:{successful:null},setup(e,{expose:a,emit:d}){const k=n(),U=n(),m=n(),q=[{title:"字段",align:"center",dataIndex:"fieldName",ellipsis:!0},{title:"注释",align:"center",dataIndex:"fieldRemark",ellipsis:!0},{title:"类型",align:"center",dataIndex:"fieldType",ellipsis:!0},{title:"实体类型",align:"center",dataIndex:"fieldJavaType",ellipsis:!0},{title:"作用类型",align:"center",dataIndex:"effectType",ellipsis:!0},{title:"字典",align:"center",dataIndex:"dictTypeCode",width:140},{title:"列表显示",align:"center",dataIndex:"whetherTable",width:80},{title:"列省略",align:"center",dataIndex:"whetherRetract",width:80},{title:"增改",align:"center",dataIndex:"whetherAddUpdate",width:80},{title:"必填",align:"center",dataIndex:"whetherRequired",width:80},{title:"唯一",align:"center",dataIndex:"whetherUnique",width:80},{title:"查询",align:"center",dataIndex:"queryWhether",width:80},{title:"查询方式",align:"center",dataIndex:"queryType"}],I=e=>U.value?(e.basicId=U.value.id,w.configList(e).then(e=>{m.value=JSON.parse(JSON.stringify(e));let a=[];return m.value.forEach((e,t)=>{for(const a in e)"Y"===e[a]&&(e[a]=!0),"N"===e[a]&&(e[a]=!1);e.isTableKey&&a.push(t),e.fieldName.toLowerCase().indexOf("delete_flag")>-1&&a.push(t),J(e)}),a&&a.forEach((e,a)=>{a>0&&(e-=1),m.value.splice(e,1)}),m.value})):new Promise((e,a)=>{e([])}),C=n([{label:"Integer",value:"Integer"},{label:"Long",value:"Long"},{label:"String",value:"String"},{label:"Boolean",value:"Boolean"},{label:"Float",value:"Float"},{label:"Double",value:"Double"},{label:"Date",value:"Date"},{label:"BigDecimal",value:"BigDecimal"}]),N=n([{label:"输入框",value:"input"},{label:"文本框",value:"textarea"},{label:"下拉框",value:"select"},{label:"单选框",value:"radio"},{label:"复选框",value:"checkbox"},{label:"日期选择器",value:"datepicker"},{label:"时间选择器",value:"timepicker"},{label:"数字输入框",value:"inputNumber"},{label:"滑动数字条",value:"slider"},{label:"图片上传",value:"imageUpload"},{label:"文件上传",value:"fileUpload"},{label:"富文本",value:"editor"}]),R=t.dictDataAll().map(e=>({label:e.name,value:e.dictValue})),_=n([{label:"模糊包含",value:"like"},{label:"模糊不包含",value:"notLike"},{label:"等于",value:"eq"},{label:"不等于",value:"ne"},{label:"大于",value:"gt"},{label:"大于等于",value:"ge"},{label:"小于",value:"lt"},{label:"小于等于",value:"le"}]),L=e=>e.fieldName.toLowerCase().indexOf("create_user")>-1||e.fieldName.toLowerCase().indexOf("create_time")>-1||e.fieldName.toLowerCase().indexOf("update_user")>-1||e.fieldName.toLowerCase().indexOf("update_time")>-1||e.fieldName.toLowerCase().indexOf("delete_flag")>-1||!0===e.isTableKey,D=e=>e.fieldName.toLowerCase().indexOf("create_user")>-1||e.fieldName.toLowerCase().indexOf("update_user")>-1,O=e=>"Date"===e.fieldJavaType&&"datepicker"===e.effectType,W=e=>!e.whetherTable||"imageUpload"===e.effectType||"fileUpload"===e.effectType,J=e=>{"Date"===e.fieldJavaType&&(e.effectType="datepicker")};return a({onOpen:e=>{U.value=e,v(()=>{k.value.refresh()})},onSubmit:e=>{let a=l(m.value),t=100;return a.forEach(e=>{for(const a in e)!0===e[a]&&(e[a]="Y"),!1===e[a]&&(e[a]="N");"Y"!==e.queryWhether||e.queryType||"Date"!==e.fieldJavaType&&"checkbox"!==e.effectType&&t++,"select"!==e.effectType&&"radio"!==e.effectType&&"checkbox"!==e.effectType||e.dictTypeCode||t++}),new Promise((e,l)=>{t>100?l("校验失败，请选择对应的下拉框选项"):w.configEditBatch(a).then(a=>{e(a)}).catch(e=>{l(e)})})}}),(e,a)=>{const t=i("question-circle-outlined"),l=i("a-tooltip"),d=i("a-input"),n=i("a-select"),v=i("a-checkbox"),w=i("a-switch"),U=i("s-table"),m=i("a-card");return c(),r(m,{bordered:!1},{default:h(()=>[o(U,{ref_key:"tableRef",ref:k,columns:q,data:I,"expand-row-by-click":!0,showPagination:!1,bordered:""},{headerCell:h(({title:e,column:d})=>["whetherRequired"===d.dataIndex?(c(),r(l,{key:0},{title:h(()=>a[0]||(a[0]=[y(" 非增改字段不可选择必填 ")])),default:h(()=>[o(t),y("  "+b(e),1)]),_:2},1024)):u("",!0),"whetherUnique"===d.dataIndex?(c(),r(l,{key:1},{title:h(()=>a[1]||(a[1]=[y(" 非必填字段不可选择唯一 ")])),default:h(()=>[o(t),y("  "+b(e),1)]),_:2},1024)):u("",!0)]),bodyCell:h(({column:e,record:a})=>["fieldRemark"===e.dataIndex?(c(),r(d,{key:0,value:a.fieldRemark,"onUpdate:value":e=>a.fieldRemark=e},null,8,["value","onUpdate:value"])):u("",!0),"fieldJavaType"===e.dataIndex?(c(),r(n,{key:1,class:"xn-wd",value:a.fieldJavaType,"onUpdate:value":e=>a.fieldJavaType=e,options:s(C),placeholder:"请选择",disabled:D(a),onChange:e=>J(a)},null,8,["value","onUpdate:value","options","disabled","onChange"])):u("",!0),"effectType"===e.dataIndex?(c(),r(n,{key:2,class:"xn-wd",value:a.effectType,"onUpdate:value":e=>a.effectType=e,options:s(N),placeholder:"请选择",disabled:D(a)||O(a),onChange:e=>(e=>{"imageUpload"!==e.effectType&&"fileUpload"!==e.effectType||(e.queryWhether="N",e.queryType=null),"editor"===e.effectType&&(e.whetherTable=!1,e.whetherRetract=!1,e.queryWhether="N",e.queryType=null)})(a)},null,8,["value","onUpdate:value","options","disabled","onChange"])):u("",!0),"dictTypeCode"===e.dataIndex?(c(),p(f,{key:3},["radio"===a.effectType||"select"===a.effectType||"checkbox"===a.effectType?(c(),r(n,{key:0,class:"xn-wd",value:a.dictTypeCode,"onUpdate:value":e=>a.dictTypeCode=e,options:s(R),placeholder:"请选择字典"},null,8,["value","onUpdate:value","options"])):(c(),p("span",g,"无"))],64)):u("",!0),"whetherTable"===e.dataIndex?(c(),r(v,{key:4,checked:a.whetherTable,"onUpdate:checked":e=>a.whetherTable=e,onChange:e=>(e=>{e.whetherTable||(e.queryWhether="N",e.queryType=null)})(a)},null,8,["checked","onUpdate:checked","onChange"])):u("",!0),"whetherRetract"===e.dataIndex?(c(),r(v,{key:5,checked:a.whetherRetract,"onUpdate:checked":e=>a.whetherRetract=e,disabled:!a.whetherTable},null,8,["checked","onUpdate:checked","disabled"])):u("",!0),"whetherAddUpdate"===e.dataIndex?(c(),r(v,{key:6,checked:a.whetherAddUpdate,"onUpdate:checked":e=>a.whetherAddUpdate=e,onChange:e=>{var t;(t=a).checked||(t.whetherRequired=!1,t.whetherUnique=!1)},disabled:L(a)},null,8,["checked","onUpdate:checked","onChange","disabled"])):u("",!0),"whetherRequired"===e.dataIndex?(c(),r(v,{key:7,checked:a.whetherRequired,"onUpdate:checked":e=>a.whetherRequired=e,onChange:e=>{var t;(t=a).checked||(t.whetherUnique=!1)},disabled:L(a)||!a.whetherAddUpdate},null,8,["checked","onUpdate:checked","onChange","disabled"])):u("",!0),"whetherUnique"===e.dataIndex?(c(),r(v,{key:8,checked:a.whetherUnique,"onUpdate:checked":e=>a.whetherUnique=e,disabled:L(a)||!a.whetherAddUpdate||!a.whetherRequired},null,8,["checked","onUpdate:checked","disabled"])):u("",!0),"queryWhether"===e.dataIndex?(c(),r(w,{key:9,checked:a.queryWhether,"onUpdate:checked":e=>a.queryWhether=e,disabled:W(a)},null,8,["checked","onUpdate:checked","disabled"])):u("",!0),"queryType"===e.dataIndex?(c(),p(f,{key:10},[!0===a.queryWhether&&"datepicker"!==a.effectType?(c(),r(n,{key:0,class:"xn-wd",value:a.queryType,"onUpdate:value":e=>a.queryType=e,options:s(_),placeholder:"请选择"},null,8,["value","onUpdate:value","options"])):"datepicker"===a.effectType&&!0===a.queryWhether?(c(),p("span",T,"时间段")):(c(),p("span",x,"无"))],64)):u("",!0)]),_:1},512)]),_:1})}}}),[["__scopeId","data-v-e833a367"]]);export{m as default};
