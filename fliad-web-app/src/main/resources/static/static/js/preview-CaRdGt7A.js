import{_ as e,t as a}from"./index-DcffTgQN.js";import{a as s,k as t}from"./ant-design-vendor-CRFwT3Wn.js";import{r as n,a as r,o}from"./office-vendor-CP0gN6-y.js";import{f as l,w as i,a1 as d,U as c,V as u,k as p,a2 as f,G as g,u as m,a6 as k,d as v}from"./vue-vendor-BzDj5Url.js";const y=s(n());const x=s(r()),_={style:{position:"relative"}},b=["src"],w=e({__name:"index",props:{src:{type:String,default:"",required:!0},fileType:{type:String,default:"defaults",required:!1}},emits:{goBack:null},setup(e,{emit:s}){const n=l(!1),r=s,v=e,w=l();i(()=>v.src,e=>{e&&(w.value=v.fileType.toLowerCase())},{immediate:!0,deep:!0}),i(()=>v.src,e=>{e&&("doc"!==w.value&&"docx"!==w.value&&"xls"!==w.value&&"xlsx"!==w.value&&"pdf"!==w.value||(n.value=!0))},{immediate:!0,deep:!0});const j=()=>{n.value=!1},h=()=>{t.warning("渲染失败，请尝试重新打开！")};return(e,s)=>{const t=d("download-outlined"),l=d("a-button"),i=d("rollback-outlined"),O=d("a-space"),T=d("a-result"),B=d("a-spin"),E=d("a-card");return u(),c("div",_,[p(O,{class:"go-back-button"},{default:f(()=>[p(l,{href:v.src,size:"small",target:"_blank"},{icon:f(()=>[p(t)]),_:1},8,["href"]),p(l,{type:"primary",size:"small",onClick:s[0]||(s[0]=e=>r("goBack"))},{icon:f(()=>[p(i)]),default:f(()=>[s[1]||(s[1]=g(" 返回 "))]),_:1})]),_:1}),p(E,{bordered:!1,"body-style":{padding:0}},{default:f(()=>[p(B,{spinning:m(n)},{default:f(()=>["doc"===m(w)||"docx"===m(w)?(u(),k(m(y),{key:0,src:v.src+"&token="+m(a).data.get("TOKEN"),class:"xn-ht82",onRendered:j},null,8,["src"])):"xls"===m(w)||"xlsx"===m(w)?(u(),k(m(x),{key:1,src:v.src+"&token="+m(a).data.get("TOKEN"),class:"xn-ht82",onRendered:j,onError:h},null,8,["src"])):"pdf"===m(w)?(u(),k(m(o),{key:2,"annotation-layer":"","text-layer":"",source:v.src+"&token="+m(a).data.get("TOKEN"),onRendered:j,onRenderingFailed:h},null,8,["source"])):"png"===m(w)||"jpg"===m(w)||"gif"===m(w)||"bmp"===m(w)||"jpeg"===m(w)||"ico"===m(w)||"svg"===m(w)?(u(),c("img",{key:3,src:v.src+"&token="+m(a).data.get("TOKEN"),class:"xn-mwh"},null,8,b)):(u(),k(T,{key:4,status:"warning",title:"不支持预览的文件类型"}))]),_:1},8,["spinning"])]),_:1})])}}},[["__scopeId","data-v-03b3c2fa"]]),j=v({name:"filePreview"}),h=Object.assign(j,{emits:{goBack:null},setup(e,{expose:a,emit:s}){const t=l(),n=l(),r=s;return a({onOpen:e=>{t.value=e.downloadPath,n.value=e.suffix}}),(e,a)=>{const s=w;return u(),k(s,{src:m(t),"file-type":m(n),onGoBack:a[0]||(a[0]=e=>r("goBack"))},null,8,["src","file-type"])}}});export{h as default};
